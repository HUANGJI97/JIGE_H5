{"remainingRequest":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-scoped-loader/index.js!/Users/lianfangti/Project/UNI-APP/JIGE/src/pages/user/message.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/src/pages/user/message.vue","mtime":1568272937791},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/vue-loader/lib/index.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-scoped-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport {getNotice, getNoticeCoin, readNotice} from \"../../api/user\";\nimport Modal from \"../component/modal\";\nimport Status from \"../component/status\";\n\nexport default {\n    name: \"message\",\n    components: {Status, Modal},\n    data(){\n        return {\n            list:[],\n            curentNotice:{},\n            detaileModelVisible:false,\n        }\n    },\n    async onLoad(){\n        uni.showLoading({\n            title:'请稍后'\n        })\n        let notices = await  getNotice();\n        this.list = notices.list\n        uni.hideLoading();\n    },\n    methods:{\n       async  handleShowDetaile(item){\n            this.curentNotice =item;\n            if(item.read_status == 0){\n                let res= await readNotice({id:item.id});\n                item.read_status = 1;\n            }\n            this.detaileModelVisible = true\n        },\n        async handleButtonClick(){\n           let {coin,type,id} = this.curentNotice;\n            if(type==='coin'){\n                let res= await getNoticeCoin({id}).catch(err=>{\n                    uni.showToast({\n                        title:'领取失败',\n                        icon:'none'\n                    })\n                    throw  err;\n                });\n                if(res){\n                    console.log(`调试:领取成功`, res);\n\n                    uni.showToast({\n                        title:'领取成功'\n                    })\n                    this.curentNotice.get_status=1;\n                }\n            }\n        }\n\n    }\n}\n",{"version":3,"sources":["message.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuCA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA","file":"message.vue","sourceRoot":"src/pages/user","sourcesContent":["<template>\n    <view>\n        <status v-if=\"!list.length\" text=\"暂无消息\"></status>\n        <view class=\"margin\">\n            <view v-for=\"(item,index) in list\"  :key=\"index\" class=\"flex bg-white margin-top-sm padding radius-xxl justify-between\" @tap=\"handleShowDetaile(item)\" >\n                <view class=\"flex \">\n                    <view class=\"flex align-center\">\n                        <view class=\"cu-avatar round lg\" style=\"background-image:url(../../static/notice_icon.png);\">\n                        </view>\n                    </view>\n                    <view class='content margin-left-sm '>\n                        <view class='text-grey'>{{item.title}}\n                            <!--                    <view class=\"cu-tag round bg-orange sm\">c</view>-->\n                        </view>\n                        <view class='text-gray text-sm margin-top-sm' style=\"overflow: hidden;text-overflow:ellipsis;\">\n                            <text class='cuIcon-redpacket_fill text-red' v-if=\"item.type==='coin' && !item.get_status\"></text>{{item.remark}}\n                        </view>\n                    </view>\n                </view>\n                <view >\n                    <view class=\"text-xs text-gray  flex justify-end\">{{item.created_at}}</view>\n                    <view class=\"flex justify-end margin-top-sm\">\n                        <view class=\"cu-tag sm round text-xxxs   margin-top-sm \" :class=\"['bg-red','bg-green'][item.read_status]\">{{['未读','已读'][item.read_status]}}</view>\n                    </view>\n                </view>\n            </view>\n            <modal v-model=\"detaileModelVisible\" hide-footer :title=\"curentNotice.title\">\n                <view v-html=\"curentNotice.content\"></view>\n                <view slot=\"footer\">\n                    <view class=\"flex bg-white justify-center padding-sm\">\n                        <button class=\"cu-btn round \" :class=\"curentNotice.coin ? 'bg-green' : 'bg-blue'\" @tap=\"handleButtonClick\"  :disabled=\"curentNotice.type === 'coin' &&  curentNotice.get_status != 0\">{{curentNotice.coin ?(curentNotice.get_status?'已领取':'领取'):'知道了'}}</button>\n                    </view>\n                </view>\n            </modal>\n        </view>\n    </view>\n</template>\n\n<script>\n    import {getNotice, getNoticeCoin, readNotice} from \"../../api/user\";\n    import Modal from \"../component/modal\";\n    import Status from \"../component/status\";\n\n    export default {\n        name: \"message\",\n        components: {Status, Modal},\n        data(){\n            return {\n                list:[],\n                curentNotice:{},\n                detaileModelVisible:false,\n            }\n        },\n        async onLoad(){\n            uni.showLoading({\n                title:'请稍后'\n            })\n            let notices = await  getNotice();\n            this.list = notices.list\n            uni.hideLoading();\n        },\n        methods:{\n           async  handleShowDetaile(item){\n                this.curentNotice =item;\n                if(item.read_status == 0){\n                    let res= await readNotice({id:item.id});\n                    item.read_status = 1;\n                }\n                this.detaileModelVisible = true\n            },\n            async handleButtonClick(){\n               let {coin,type,id} = this.curentNotice;\n                if(type==='coin'){\n                    let res= await getNoticeCoin({id}).catch(err=>{\n                        uni.showToast({\n                            title:'领取失败',\n                            icon:'none'\n                        })\n                        throw  err;\n                    });\n                    if(res){\n                        console.log(`调试:领取成功`, res);\n\n                        uni.showToast({\n                            title:'领取成功'\n                        })\n                        this.curentNotice.get_status=1;\n                    }\n                }\n            }\n\n        }\n    }\n</script>\n\n<style scoped scoped>\n\n</style>\n"]}]}