{"remainingRequest":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-scoped-loader/index.js!/Users/lianfangti/Project/UNI-APP/JIGE/src/pages/login/login.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/src/pages/login/login.vue","mtime":1568221667376},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/vue-loader/lib/index.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-scoped-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n\nimport {getAccessToken, getMobile, Login} from \"../../api/user\";\nimport { decodeParams } from \"../../utils/utils\"\nimport cache from \"../../utils/cache\";\n\n\nexport default {\n    name: \"login\",\n    data() {\n        return {\n            loading: false\n        }\n    },\n    async onLoad(){\n        let tokens = cache.get(\"tokens\");\n        let query = decodeParams(window.location.href);\n        let {token,code,state,}  =query;\n\n\n        console.log(`调试:获取缓存`, tokens);\n\n        if(cache.get(\"X-Token\")){\n            if(token){\n                cache.set(\"token\",token);\n            }\n            uni.reLaunch({\n                url:'../user/user'\n            });\n            return 0;\n        }else if(code){\n            let res = await getAccessToken({code,token:state});\n            cache.set(\"token\",state);\n            uni.reLaunch({\n                url:'../user/user'\n            });\n            console.log(`调试:获取`, res);\n            return 0;\n        }else if(token){\n            console.log(`调试不存在缓存正在调用登录:`);\n            Login({token,env:'prod'});\n        }else{\n            console.log(`调试:啥都没有 程序结束`,query,tokens)\n        }\n\n        //\n        // if(code){\n        //\n        // }\n        // if(!query.token){\n        //     console.log(`调试:没有获取token程序结束`,query,window.location.href);\n        //     return\n        // }\n\n\n\n\n\n    },\n    methods: {\n        handleLogin() {\n                // Login()\n            uni.reLaunch({\n                url:'../index/index'\n            })\n        },\n        async handleGetMobile(res) {\n            let { detail } = res;\n            let {encryptedData,iv }= detail;\n            console.log(`调试:获取手机号调试`, encryptedData)\n            await  getMobile({encryptedData,iv });\n\n        },\n        async handelGetUserInfo(res) {\n            const { detail } = res;\n            const { userInfo,encryptedData,iv } = detail;\n            let token = await  Login();\n            this.loading = false\n            uni.redirectTo({\n                url: '../index/index'\n            })\n\n        }\n    }\n}\n",{"version":3,"sources":["login.vue"],"names":[],"mappings":";;;;;;;;AAQA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"login.vue","sourceRoot":"src/pages/login","sourcesContent":["<template>\n    <view class=\"cu-page   \">\n        <img src=\"../../static/haibao.jpg\" style=\"height: 100%;width: 100%;\">\n    </view>\n\n</template>\n\n<script>\n    import {getAccessToken, getMobile, Login} from \"../../api/user\";\n    import { decodeParams } from \"../../utils/utils\"\n    import cache from \"../../utils/cache\";\n\n\n    export default {\n        name: \"login\",\n        data() {\n            return {\n                loading: false\n            }\n        },\n        async onLoad(){\n            let tokens = cache.get(\"tokens\");\n            let query = decodeParams(window.location.href);\n            let {token,code,state,}  =query;\n\n\n            console.log(`调试:获取缓存`, tokens);\n\n            if(cache.get(\"X-Token\")){\n                if(token){\n                    cache.set(\"token\",token);\n                }\n                uni.reLaunch({\n                    url:'../user/user'\n                });\n                return 0;\n            }else if(code){\n                let res = await getAccessToken({code,token:state});\n                cache.set(\"token\",state);\n                uni.reLaunch({\n                    url:'../user/user'\n                });\n                console.log(`调试:获取`, res);\n                return 0;\n            }else if(token){\n                console.log(`调试不存在缓存正在调用登录:`);\n                Login({token,env:'prod'});\n            }else{\n                console.log(`调试:啥都没有 程序结束`,query,tokens)\n            }\n\n            //\n            // if(code){\n            //\n            // }\n            // if(!query.token){\n            //     console.log(`调试:没有获取token程序结束`,query,window.location.href);\n            //     return\n            // }\n\n\n\n\n\n        },\n        methods: {\n            handleLogin() {\n                    // Login()\n                uni.reLaunch({\n                    url:'../index/index'\n                })\n            },\n            async handleGetMobile(res) {\n                let { detail } = res;\n                let {encryptedData,iv }= detail;\n                console.log(`调试:获取手机号调试`, encryptedData)\n                await  getMobile({encryptedData,iv });\n\n            },\n            async handelGetUserInfo(res) {\n                const { detail } = res;\n                const { userInfo,encryptedData,iv } = detail;\n                let token = await  Login();\n                this.loading = false\n                uni.redirectTo({\n                    url: '../index/index'\n                })\n\n            }\n        }\n    }\n</script>\n\n<style scoped scoped>\n    .bg-milk {\n        background-image: url(\"https://deepand.oss-cn-shenzhen.aliyuncs.com/image/bg-image-milk3.jpg\");\n        /*background-image:url(\"https://deepand.oss-cn-shenzhen.aliyuncs.com/image/bg-milk.jpg\") ;*/\n        /*background-image:url(\"https://deepand.oss-cn-shenzhen.aliyuncs.com/image/bg-image-milk.jpg\") ;*/\n        background-size: cover;\n        /*background-color: #f4f5f0;*/\n    }\n\n    .bg-cow {\n        background-image: url(\"https://deepand.oss-cn-shenzhen.aliyuncs.com/image/mow-huawen.jpeg\");\n        background-size: cover;\n        /*color: white;*/\n    }\n\n    .footer {\n        width: 70vw;\n        position: absolute;\n        left: 0px;\n        right: 0px;\n        bottom: 40px;\n        margin: 0 auto;\n        /*bottom: 0px;*/\n        /*left: 0px;*/\n        /*right: 0px;*/\n    }\n\n    /*https://deepand.oss-cn-shenzhen.aliyuncs.com/image/mow-huawen.jpeg*/\n</style>\n"]}]}