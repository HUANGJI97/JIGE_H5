{"remainingRequest":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-scoped-loader/index.js!/Users/lianfangti/Project/UNI-APP/JIGE/src/pages/rankingList/rankingList.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/src/pages/rankingList/rankingList.vue","mtime":1564817488194},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/vue-loader/lib/index.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-scoped-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport {getExtensionUser, getRanking} from \"../../api/user\";\nimport cache from \"../../utils/cache\";\nimport {randomIntegerInRange} from \"../../utils/utils\";\n\nexport default {\n    name: \"rankingList\",\n    data(){\n      return{\n          ranking:[],\n          index:0,\n          userInfo:cache.get(\"userInfo\"),\n          active:0,\n          gifts:[],\n          ex_count:0,\n          tabs:[{name:'周榜',key:'week'},{name:'月榜',key:'month'},{name:'总榜',key:'all'}],\n          exInfo:{}\n      }\n    },\n    async onLoad(){\n        this.loadData({index:this.active});\n\n    },\n    methods:{\n        async handleTabChange(index){\n            this.active=index;\n            this.loadData({index});\n\n        },\n        async loadData({index = 0}= {}){\n            uni.showLoading({\n                title:'请稍后..'\n            });\n           let data =  await getRanking({type:this.tabs[index].key});\n            this.ranking = data.rank;\n            this.ex_count = data.ex_count\n            // this.ex_count =data.ex_count;\n            // this.gifts = data.ranking;\n            // let realExCount = this.ranking.length >0 ? this.ranking[0]['ex_count'] : 0; //真实的最大数据\n            // realExCount =  realExCount *1\n            // console.log(`调试:真实的最大邀请量`, realExCount);\n            // for(let i=0;i<10;i++){\n            //       this.ranking.push({\n            //           ex_count: randomIntegerInRange(realExCount,realExCount+100),\n            //           headimgurl:'https://cdn.nlark.com/yuque/0/2018/jpeg/anonymous/1544580626166-9faae07c-19d7-44fd-bbb1-2d246fcc0131.jpeg?x-oss-process=image/resize,m_fill,w_64,h_64/format,png',\n            //           nickname:'Fake User'\n            //       })\n            // }\n            // this.ranking.sort((item1,item2)=>{\n            //     return item2[\"ex_count\"] - item1[\"ex_count\"];\n            // });\n            // this.exInfo= await getExtensionUser({type:this.tabs[index].key});\n            for(let index in this.ranking){\n                if(this.userInfo.id == this.ranking[index].uid){\n                    this.index = (index * 1) +1;\n                    break;\n                }\n            }\n            uni.hideLoading();\n        }\n    }\n}\n",{"version":3,"sources":["rankingList.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6CA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"rankingList.vue","sourceRoot":"src/pages/rankingList","sourcesContent":["<template>\n  <view>\n      <view class=\"bg-blue flex  padding-xl justify-between shadow-blur shadow\" style=\"height: 300rpx;padding-left: 100rpx;padding-right: 100rpx;\"  hover-class=\"bg-gradual-blue\">\n           <view class=\" flex align-end\">\n               邀\n               <text class=\"text-xxl\">{{ex_count}}</text>人\n           </view>\n           <view class=\"flex align-end\">\n               <view class=\"text-center\">\n                   <view class=\"margin-bottom\">{{userInfo.nickname}}</view>\n                   <view class=\"cu-avatar xl round\" :style=\"'background-image: url('+userInfo.headimgurl+')'\"></view>\n               </view>\n           </view>\n           <view class=\" flex align-end\">\n               <div v-if=\"ex_count == 0 || index >20\">\n                   未上榜\n               </div>\n               <div v-else>\n                   第\n                   <text class=\"text-xxl\">{{this.index}}</text>\n                   <text>名</text></div>\n           </view>\n      </view>\n      <view class=\"bg-white padding-sm\">\n          <view class=\"flex justify-between margin  round bg-gray shadow\">\n                <view class=\"flex-sub text-center padding-sm round \" :class=\"active === index ? 'bg-blue' :''\" hover-class=\"bg-gradual-blue\" v-for=\"(item,index) in tabs\" @click=\"handleTabChange(index)\">{{item.name}}</view>\n          </view>\n      </view>\n      <view>\n          <view class=\"flex bg-white padding  align-center\" v-for=\"(item,index) in ranking.slice(0,20)\" >\n              <view class=\"flex flex-sub align-center\">\n                  <view class=\"align-center  margin-left margin-right text-bold \">{{(index + 1)>9?index + 1:`0${index + 1}`}}</view>\n                   <view class=\"cu-avatar round margin-right-sm md\" :style=\"'background-image: url('+item.headimgurl+')'\"></view>\n                   <view>\n                       <view>{{item.nickname}}</view>\n                       <view v-if=\"index<11 && active <2\" class=\"text-xs text-gray\">赠:{{item.reward ? item.reward.name : '无'}}</view>\n                   </view>\n              </view>\n              <view class=\"text-xxl margin-right-xl\">{{item.value + item.fake}}</view>\n          </view>\n      </view>\n  </view>\n</template>\n\n<script>\n    import {getExtensionUser, getRanking} from \"../../api/user\";\n    import cache from \"../../utils/cache\";\n    import {randomIntegerInRange} from \"../../utils/utils\";\n\n    export default {\n        name: \"rankingList\",\n        data(){\n          return{\n              ranking:[],\n              index:0,\n              userInfo:cache.get(\"userInfo\"),\n              active:0,\n              gifts:[],\n              ex_count:0,\n              tabs:[{name:'周榜',key:'week'},{name:'月榜',key:'month'},{name:'总榜',key:'all'}],\n              exInfo:{}\n          }\n        },\n        async onLoad(){\n            this.loadData({index:this.active});\n\n        },\n        methods:{\n            async handleTabChange(index){\n                this.active=index;\n                this.loadData({index});\n\n            },\n            async loadData({index = 0}= {}){\n                uni.showLoading({\n                    title:'请稍后..'\n                });\n               let data =  await getRanking({type:this.tabs[index].key});\n                this.ranking = data.rank;\n                this.ex_count = data.ex_count\n                // this.ex_count =data.ex_count;\n                // this.gifts = data.ranking;\n                // let realExCount = this.ranking.length >0 ? this.ranking[0]['ex_count'] : 0; //真实的最大数据\n                // realExCount =  realExCount *1\n                // console.log(`调试:真实的最大邀请量`, realExCount);\n                // for(let i=0;i<10;i++){\n                //       this.ranking.push({\n                //           ex_count: randomIntegerInRange(realExCount,realExCount+100),\n                //           headimgurl:'https://cdn.nlark.com/yuque/0/2018/jpeg/anonymous/1544580626166-9faae07c-19d7-44fd-bbb1-2d246fcc0131.jpeg?x-oss-process=image/resize,m_fill,w_64,h_64/format,png',\n                //           nickname:'Fake User'\n                //       })\n                // }\n                // this.ranking.sort((item1,item2)=>{\n                //     return item2[\"ex_count\"] - item1[\"ex_count\"];\n                // });\n                // this.exInfo= await getExtensionUser({type:this.tabs[index].key});\n                for(let index in this.ranking){\n                    if(this.userInfo.id == this.ranking[index].uid){\n                        this.index = (index * 1) +1;\n                        break;\n                    }\n                }\n                uni.hideLoading();\n            }\n        }\n    }\n</script>\n\n<style scoped scoped>\n\n</style>\n"]}]}