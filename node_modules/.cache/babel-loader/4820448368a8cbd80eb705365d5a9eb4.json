{"remainingRequest":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js!/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-2!/Users/lianfangti/Project/UNI-APP/JIGE/src/api/orders.js","dependencies":[{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/src/api/orders.js","mtime":1562513796143},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getRechargeList = getRechargeList;\nexports.pay = pay;\nexports.createOrder = createOrder;\nexports.createAndPaymentOrder = createAndPaymentOrder;\nexports.checkRechargeReuslt = checkRechargeReuslt;\nexports.getRechargeRecord = getRechargeRecord;\nexports.getUsedRecord = getUsedRecord;\n\nvar _regenerator = _interopRequireDefault(require(\"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@babel/runtime/regenerator\"));\n\nvar _request = require(\"../utils/request\");\n\nvar _utils = require(\"../utils/utils\");\n\nvar _cache = _interopRequireDefault(require(\"../utils/cache\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nfunction getRechargeList() {\n  return _getRechargeList.apply(this, arguments);\n}\n\nfunction _getRechargeList() {\n  _getRechargeList = _asyncToGenerator(\n  /*#__PURE__*/\n  _regenerator.default.mark(function _callee() {\n    var result;\n    return _regenerator.default.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return _request.request.get({\n              url: \"/jige/recharge\"\n            });\n\n          case 2:\n            result = _context.sent;\n            return _context.abrupt(\"return\", result.data);\n\n          case 4:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n  return _getRechargeList.apply(this, arguments);\n}\n\nfunction pay(_x) {\n  return _pay.apply(this, arguments);\n}\n\nfunction _pay() {\n  _pay = _asyncToGenerator(\n  /*#__PURE__*/\n  _regenerator.default.mark(function _callee2(_ref) {\n    var repid, _cache$get, id, openid, result;\n\n    return _regenerator.default.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            repid = _ref.repid;\n            _cache$get = _cache.default.get(\"userInfo\"), id = _cache$get.id, openid = _cache$get.openid;\n            _context2.next = 4;\n            return _request.request.post({\n              url: '/jige/pay',\n              data: {\n                uid: id,\n                repid: repid,\n                openid: openid\n              }\n            });\n\n          case 4:\n            result = _context2.sent;\n\n            if (result.data) {\n              window.location.href = result.data;\n            }\n\n            return _context2.abrupt(\"return\", result.data);\n\n          case 7:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  }));\n  return _pay.apply(this, arguments);\n}\n\nfunction createOrder(_x2) {\n  return _createOrder.apply(this, arguments);\n} // 创建 并且支付订单\n\n\nfunction _createOrder() {\n  _createOrder = _asyncToGenerator(\n  /*#__PURE__*/\n  _regenerator.default.mark(function _callee3(_ref2) {\n    var price, cardno;\n    return _regenerator.default.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            price = _ref2.price, cardno = _ref2.cardno;\n            _context3.next = 3;\n            return _request.request.post({\n              url: \"/createordergetsign\",\n              data: {\n                moneyyuan: price,\n                cardno: cardno\n              }\n            });\n\n          case 3:\n            return _context3.abrupt(\"return\", _context3.sent);\n\n          case 4:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3);\n  }));\n  return _createOrder.apply(this, arguments);\n}\n\nfunction createAndPaymentOrder(_x3) {\n  return _createAndPaymentOrder.apply(this, arguments);\n}\n\nfunction _createAndPaymentOrder() {\n  _createAndPaymentOrder = _asyncToGenerator(\n  /*#__PURE__*/\n  _regenerator.default.mark(function _callee4(_ref3) {\n    var price, cardno, orders, payResult;\n    return _regenerator.default.wrap(function _callee4$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            price = _ref3.price, cardno = _ref3.cardno;\n            _context4.next = 3;\n            return createOrder({\n              price: price,\n              cardno: cardno\n            });\n\n          case 3:\n            orders = _context4.sent;\n            console.log(\"\\u8C03\\u8BD5:\\u8BA2\\u5355\\u521B\\u5EFA\\u8FD4\\u56DE\\u503C\", orders);\n            _context4.next = 7;\n            return (0, _utils.requestPayment)(orders);\n\n          case 7:\n            payResult = _context4.sent;\n            return _context4.abrupt(\"return\", _objectSpread({}, orders, payResult));\n\n          case 9:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, _callee4);\n  }));\n  return _createAndPaymentOrder.apply(this, arguments);\n}\n\nfunction checkRechargeReuslt(_x4) {\n  return _checkRechargeReuslt.apply(this, arguments);\n} //充值记录\n\n\nfunction _checkRechargeReuslt() {\n  _checkRechargeReuslt = _asyncToGenerator(\n  /*#__PURE__*/\n  _regenerator.default.mark(function _callee5(_ref4) {\n    var outtradeno;\n    return _regenerator.default.wrap(function _callee5$(_context5) {\n      while (1) {\n        switch (_context5.prev = _context5.next) {\n          case 0:\n            outtradeno = _ref4.outtradeno;\n            _context5.next = 3;\n            return _request.request.post({\n              url: '/checkrechargeresult',\n              data: {\n                outtradeno: outtradeno\n              }\n            });\n\n          case 3:\n            return _context5.abrupt(\"return\", _context5.sent);\n\n          case 4:\n          case \"end\":\n            return _context5.stop();\n        }\n      }\n    }, _callee5);\n  }));\n  return _checkRechargeReuslt.apply(this, arguments);\n}\n\nfunction getRechargeRecord() {\n  return _getRechargeRecord.apply(this, arguments);\n} // 消费记录\n\n\nfunction _getRechargeRecord() {\n  _getRechargeRecord = _asyncToGenerator(\n  /*#__PURE__*/\n  _regenerator.default.mark(function _callee6() {\n    var _ref5,\n        _ref5$page,\n        page,\n        _ref5$size,\n        size,\n        _cache$get2,\n        id,\n        _args6 = arguments;\n\n    return _regenerator.default.wrap(function _callee6$(_context6) {\n      while (1) {\n        switch (_context6.prev = _context6.next) {\n          case 0:\n            _ref5 = _args6.length > 0 && _args6[0] !== undefined ? _args6[0] : {}, _ref5$page = _ref5.page, page = _ref5$page === void 0 ? 1 : _ref5$page, _ref5$size = _ref5.size, size = _ref5$size === void 0 ? 20 : _ref5$size;\n            _cache$get2 = _cache.default.get(\"userInfo\"), id = _cache$get2.id;\n            _context6.next = 4;\n            return _request.request.get({\n              url: '/jige/rechargerecord',\n              data: {\n                id: id,\n                page: page,\n                size: size\n              }\n            }).then(function (res) {\n              return Promise.resolve(res.data);\n            });\n\n          case 4:\n            return _context6.abrupt(\"return\", _context6.sent);\n\n          case 5:\n          case \"end\":\n            return _context6.stop();\n        }\n      }\n    }, _callee6);\n  }));\n  return _getRechargeRecord.apply(this, arguments);\n}\n\nfunction getUsedRecord(_x5) {\n  return _getUsedRecord.apply(this, arguments);\n}\n\nfunction _getUsedRecord() {\n  _getUsedRecord = _asyncToGenerator(\n  /*#__PURE__*/\n  _regenerator.default.mark(function _callee7(_ref6) {\n    var cardno, starttime, _ref6$recordnum, recordnum;\n\n    return _regenerator.default.wrap(function _callee7$(_context7) {\n      while (1) {\n        switch (_context7.prev = _context7.next) {\n          case 0:\n            cardno = _ref6.cardno, starttime = _ref6.starttime, _ref6$recordnum = _ref6.recordnum, recordnum = _ref6$recordnum === void 0 ? 20 : _ref6$recordnum;\n            _context7.next = 3;\n            return _request.request.post({\n              url: '/usedrecord',\n              data: {\n                cardno: cardno,\n                recordnum: recordnum\n              }\n            }).then(function (res) {\n              return Promise.resolve(res.record);\n            });\n\n          case 3:\n            return _context7.abrupt(\"return\", _context7.sent);\n\n          case 4:\n          case \"end\":\n            return _context7.stop();\n        }\n      }\n    }, _callee7);\n  }));\n  return _getUsedRecord.apply(this, arguments);\n}",{"version":3,"sources":["/Users/lianfangti/Project/UNI-APP/JIGE/src/api/orders.js"],"names":["getRechargeList","request","get","url","result","data","pay","repid","cache","id","openid","post","uid","window","location","href","createOrder","price","cardno","moneyyuan","createAndPaymentOrder","orders","console","log","payResult","checkRechargeReuslt","outtradeno","getRechargeRecord","page","size","then","res","Promise","resolve","getUsedRecord","starttime","recordnum","record"],"mappings":"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","sourcesContent":["// 充值套餐获取\nimport {request} from \"../utils/request\";\nimport {requestPayment} from \"../utils/utils\";\nimport cache from \"../utils/cache\";\n\nexport async function getRechargeList(){\n    let result = await  request.get({\n        url:\"/jige/recharge\",\n    });\n    return  result.data;\n}\n\nexport async function pay({repid}){\n  let {id,openid}=cache.get(\"userInfo\");\n  let result = await request.post({\n    url:'/jige/pay',\n    data:{\n        uid: id,\n        repid,\n        openid\n    }\n  });\n  if(result.data){\n      window.location.href = result.data\n  }\n  return result.data\n}\n\n\nexport async function createOrder({price,cardno}){\n    return  await  request.post({\n        url:\"/createordergetsign\",\n        data:{\n            moneyyuan:price,\n            cardno\n        }\n    });\n}\n\n// 创建 并且支付订单\nexport async function createAndPaymentOrder({price,cardno}){\n    let orders = await  createOrder({price,cardno});\n    console.log(`调试:订单创建返回值`, orders);\n    let payResult =await requestPayment(orders);\n    return  {...orders,...payResult}\n}\n\n\nexport async function checkRechargeReuslt({outtradeno}){\n    return  await request.post({\n        url:'/checkrechargeresult',\n        data:{\n            outtradeno\n        }\n    })\n}\n\n//充值记录\nexport async function getRechargeRecord({page=1,size=20}={}){\n    let {id} = cache.get(\"userInfo\");\n    return  await request.get({\n        url:'/jige/rechargerecord',\n        data:{\n            id,\n            page,\n            size\n        }\n    }).then(res=>{\n        return Promise.resolve(res.data);\n    })\n}\n\n// 消费记录\nexport async function getUsedRecord({cardno,starttime,recordnum=20}){\n    return  await request.post({\n        url:'/usedrecord',\n        data:{\n            cardno,\n            recordnum\n        }\n    }).then(res=>{\n        return Promise.resolve(res.record);\n    })\n}\n"]}]}