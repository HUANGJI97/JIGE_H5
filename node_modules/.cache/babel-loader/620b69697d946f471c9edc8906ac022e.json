{"remainingRequest":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/thread-loader/dist/cjs.js!/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js!/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-3!/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-scoped-loader/index.js!/Users/lianfangti/Project/UNI-APP/JIGE/src/pages/addCard/addCard.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/src/pages/addCard/addCard.vue","mtime":1562206625257},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/vue-loader/lib/index.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-scoped-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _regenerator = _interopRequireDefault(require(\"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@babel/runtime/regenerator\"));\n\nvar _card = require(\"../../api/card\");\n\nvar _utils = require(\"../../utils/utils\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nvar _default = {\n  name: \"addCard\",\n  data: function data() {\n    return {\n      submiting: false,\n      cardno: '',\n      school: ''\n    };\n  },\n  methods: {\n    handleSubmit: function () {\n      var _handleSubmit = _asyncToGenerator(\n      /*#__PURE__*/\n      _regenerator.default.mark(function _callee() {\n        var result;\n        return _regenerator.default.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                console.log(\"\\u8C03\\u8BD5:\\u5F53\\u524D\\u5361\\u53F7\", this.cardno);\n\n                if (!(this.school && this.school !== '')) {\n                  _context.next = 14;\n                  break;\n                }\n\n                this.submiting = true;\n                _context.next = 5;\n                return (0, _card.addCard)({\n                  cardno: this.cardno\n                }).catch(function (err) {\n                  uni.hideLoading();\n                  uni.showToast({\n                    title: '添加失败'\n                  });\n                  console.log(\"\\u8C03\\u8BD5:\\u6DFB\\u52A0\\u5931\\u8D25\", err);\n                });\n\n              case 5:\n                result = _context.sent;\n                this.submiting = false;\n                uni.showToast({\n                  title: '绑定成功'\n                });\n                _context.next = 10;\n                return (0, _utils.delay)(1000);\n\n              case 10:\n                console.log(\"\\u8C03\\u8BD5:\\u7ED1\\u5B9A\\u6210\\u529F\", this.result);\n                uni.navigateBack(-1);\n                _context.next = 15;\n                break;\n\n              case 14:\n                uni.showToast({\n                  title: '卡号不正确',\n                  icon: 'none'\n                });\n\n              case 15:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function handleSubmit() {\n        return _handleSubmit.apply(this, arguments);\n      }\n\n      return handleSubmit;\n    }(),\n    handleCardnoCahnge: function () {\n      var _handleCardnoCahnge = _asyncToGenerator(\n      /*#__PURE__*/\n      _regenerator.default.mark(function _callee2() {\n        var _this = this;\n\n        return _regenerator.default.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                console.log(\"\\u8C03\\u8BD5:\\u5F53\\u524D\\u5361\\u53F7\", this.cardno, this.cardno.length);\n\n                if (!(this.cardno.length === 10)) {\n                  _context2.next = 8;\n                  break;\n                }\n\n                _context2.next = 4;\n                return (0, _card.getSchoolNameByCard)({\n                  cardno: this.cardno\n                }).catch(function (res) {\n                  _this.school = '';\n                });\n\n              case 4:\n                this.school = _context2.sent;\n                console.log(\"\\u8C03\\u8BD5:\\u83B7\\u53D6\\u5230\\u7684\\u6821\\u540D\", this.school);\n                _context2.next = 9;\n                break;\n\n              case 8:\n                this.school = '';\n\n              case 9:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function handleCardnoCahnge() {\n        return _handleCardnoCahnge.apply(this, arguments);\n      }\n\n      return handleCardnoCahnge;\n    }()\n  }\n};\nexports.default = _default;",{"version":3,"sources":["addCard.vue"],"names":[],"mappings":";;;;;;;;;AAsBA;;AACA;;;;;;;;eAEA;AACA,EAAA,IAAA,EAAA,SADA;AAEA,EAAA,IAFA,kBAEA;AACA,WAAA;AACA,MAAA,SAAA,EAAA,KADA;AAEA,MAAA,MAAA,EAAA,EAFA;AAGA,MAAA,MAAA,EAAA;AAHA,KAAA;AAKA,GARA;AASA,EAAA,OAAA,EAAA;AACA,IAAA,YADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA,gBAAA,OAAA,CAAA,GAAA,0CAAA,KAAA,MAAA;;AAFA,sBAGA,KAAA,MAAA,IAAA,KAAA,MAAA,KAAA,EAHA;AAAA;AAAA;AAAA;;AAIA,qBAAA,SAAA,GAAA,IAAA;AAJA;AAAA,uBAKA,mBAAA;AAAA,kBAAA,MAAA,EAAA,KAAA;AAAA,iBAAA,EAAA,KAAA,CAAA,UAAA,GAAA,EAAA;AACA,kBAAA,GAAA,CAAA,WAAA;AACA,kBAAA,GAAA,CAAA,SAAA,CAAA;AAAA,oBAAA,KAAA,EAAA;AAAA,mBAAA;AACA,kBAAA,OAAA,CAAA,GAAA,0CAAA,GAAA;AACA,iBAJA,CALA;;AAAA;AAKA,gBAAA,MALA;AAUA,qBAAA,SAAA,GAAA,KAAA;AACA,gBAAA,GAAA,CAAA,SAAA,CAAA;AACA,kBAAA,KAAA,EAAA;AADA,iBAAA;AAXA;AAAA,uBAcA,kBAAA,IAAA,CAdA;;AAAA;AAeA,gBAAA,OAAA,CAAA,GAAA,0CAAA,KAAA,MAAA;AACA,gBAAA,GAAA,CAAA,YAAA,CAAA,CAAA,CAAA;AAhBA;AAAA;;AAAA;AAkBA,gBAAA,GAAA,CAAA,SAAA,CAAA;AACA,kBAAA,KAAA,EAAA,OADA;AAEA,kBAAA,IAAA,EAAA;AAFA,iBAAA;;AAlBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAwBA,IAAA,kBAxBA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAyBA,gBAAA,OAAA,CAAA,GAAA,0CAAA,KAAA,MAAA,EAAA,KAAA,MAAA,CAAA,MAAA;;AAzBA,sBA0BA,KAAA,MAAA,CAAA,MAAA,KAAA,EA1BA;AAAA;AAAA;AAAA;;AAAA;AAAA,uBA2BA,+BAAA;AAAA,kBAAA,MAAA,EAAA,KAAA;AAAA,iBAAA,EAAA,KAAA,CAAA,UAAA,GAAA,EAAA;AACA,kBAAA,KAAA,CAAA,MAAA,GAAA,EAAA;AACA,iBAFA,CA3BA;;AAAA;AA2BA,qBAAA,MA3BA;AA8BA,gBAAA,OAAA,CAAA,GAAA,sDAAA,KAAA,MAAA;AA9BA;AAAA;;AAAA;AAgCA,qBAAA,MAAA,GAAA,EAAA;;AAhCA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AATA,C","sourcesContent":["<template>\n   <view>\n       <cu-custom class=\"\" :isBack=\"true\">\n           <block slot=\"content\">添加卡片</block>\n       </cu-custom>\n       <view class=\"cu-card\">\n           <view class=\"cu-form-group\">\n               <view class='title'>卡号</view>\n               <input placeholder=\"请输入卡号\" v-model=\"cardno\"  type=\"number\" class='radius' name='input' @input=\"handleCardnoCahnge\"></input>\n               <text class='cuIcon-card text-gray'></text>\n           </view>\n           <view class=\"cu-form-group\">\n               <view class='title'>学校</view>\n               <input placeholder=\"请输入卡号自动识别\" v-model=\"school\" class='radius' disabled=\"disabled\" name='input'></input>\n               <text class='cuIcon-group_fill text-gray'></text>\n           </view>\n       </view>\n       <button class='cu-btn block bg-green lg  margin-top-xl cuIcon-add'  @click=\"handleSubmit\" :disabled=\"submiting\" :loading=\"submiting\"  >绑定</button>\n   </view>\n</template>\n\n<script>\n    import {addCard, getSchoolNameByCard} from \"../../api/card\";\n  import {delay} from \"../../utils/utils\";\n\n    export default {\n        name: \"addCard\",\n        data(){\n            return{\n                submiting:false,\n                cardno:'',\n                school:'',\n            }\n        },\n        methods:{\n            async handleSubmit(){\n                console.log(`调试:当前卡号`,this.cardno);\n                if(this.school && this.school !== ''){\n                    this.submiting = true;\n                    let result = await  addCard({cardno:this.cardno}).catch(err=>{\n                        uni.hideLoading();\n                        uni.showToast({title:'添加失败'})\n                        console.log(`调试:添加失败`, err)\n                    });\n                    this.submiting = false;\n                    uni.showToast({\n                        title:'绑定成功'\n                    })\n                    await  delay(1000);\n                    console.log(`调试:绑定成功`, this.result)\n                    uni.navigateBack(-1);\n                }else{\n                    uni.showToast({\n                        title:'卡号不正确',\n                        icon:'none'\n                    })\n                }\n            },\n            async handleCardnoCahnge(){\n                console.log(`调试:当前卡号`,this.cardno,this.cardno.length);\n                if(this.cardno.length === 10){\n                   this.school =  await  getSchoolNameByCard({cardno:this.cardno}).catch(res=>{\n                       this.school =''\n                   })\n                    console.log(`调试:获取到的校名`, this.school)\n                }else{\n                    this.school = ''\n                }\n\n            }\n        }\n    }\n</script>\n\n<style scoped scoped>\n    .footer{\n        width: 70vw;\n        position: absolute;\n        left: 0px;\n        right: 0px;\n        bottom: 40px;\n        margin: 0 auto;\n        /*bottom: 0px;*/\n        /*left: 0px;*/\n        /*right: 0px;*/\n    }\n</style>\n"],"sourceRoot":"src/pages/addCard"}]}