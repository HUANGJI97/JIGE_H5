{"remainingRequest":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/thread-loader/dist/cjs.js!/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js!/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-3!/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-scoped-loader/index.js!/Users/lianfangti/Project/UNI-APP/JIGE/src/pages/user/user.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/src/pages/user/user.vue","mtime":1562658141540},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/vue-loader/lib/index.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-scoped-loader/index.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/vue-loader/lib/index.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-scoped-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _regenerator = _interopRequireDefault(require(\"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@babel/runtime/regenerator\"));\n\nvar _page = _interopRequireDefault(require(\"../component/page/page\"));\n\nvar _modal = _interopRequireDefault(require(\"../component/modal\"));\n\nvar _utils = require(\"../../utils/utils\");\n\nvar _user = require(\"../../api/user\");\n\nvar _cache = _interopRequireDefault(require(\"../../utils/cache\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nvar _default = {\n  name: \"user\",\n  components: {\n    Modal: _modal.default,\n    Page: _page.default\n  },\n  data: function data() {\n    return {\n      modelKefu: false,\n      modelEx: false,\n      exinfo: {},\n      userInfo: {},\n      exCode: null,\n      signInfo: {\n        signed: true\n      }\n    };\n  },\n  onLoad: function () {\n    var _onLoad = _asyncToGenerator(\n    /*#__PURE__*/\n    _regenerator.default.mark(function _callee(options) {\n      return _regenerator.default.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              console.log(\"\\u8C03\\u8BD5:\\u83B7\\u53D6\\u5230token\", options);\n              this.loadData();\n\n            case 2:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, this);\n    }));\n\n    function onLoad(_x) {\n      return _onLoad.apply(this, arguments);\n    }\n\n    return onLoad;\n  }(),\n  created: function created(options) {// console.log(`调试:create->options`, options)\n  },\n  methods: {\n    loadData: function () {\n      var _loadData = _asyncToGenerator(\n      /*#__PURE__*/\n      _regenerator.default.mark(function _callee2() {\n        var token, tokens, xToken, access_token, openid;\n        return _regenerator.default.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                token = _cache.default.get(\"token\"); // cache.set(\"token\",token);\n\n                uni.showLoading({\n                  title: 'loading'\n                });\n                tokens = _cache.default.get(\"tokens\");\n                xToken = _cache.default.get(\"X-Token\");\n\n                if (!xToken) {\n                  _context2.next = 26;\n                  break;\n                }\n\n                _context2.prev = 5;\n                access_token = tokens.access_token, openid = tokens.openid;\n                _context2.next = 9;\n                return (0, _user.getUserInfo)({\n                  access_token: access_token,\n                  token: token,\n                  openid: openid\n                });\n\n              case 9:\n                this.userInfo = _context2.sent;\n                _context2.next = 12;\n                return (0, _user.checkSignin)();\n\n              case 12:\n                this.signInfo = _context2.sent;\n                console.log(\"\\u8C03\\u8BD5:\\u83B7\\u53D6\\u5230\\u7684\\u7B7E\\u5230\\u4FE1\\u606F\", this.signInfo);\n                _context2.next = 16;\n                return (0, _user.getExtensionUser)({\n                  page: 1,\n                  size: 5\n                });\n\n              case 16:\n                this.exinfo = _context2.sent;\n                // this.exinfo =exinfo\n                // console.log(`调试:获取到推广用户信息`, exinfo)\n                uni.hideLoading();\n                _context2.next = 24;\n                break;\n\n              case 20:\n                _context2.prev = 20;\n                _context2.t0 = _context2[\"catch\"](5);\n                console.log(\"\\u8C03\\u8BD5:\\u51FA\\u9519\", _context2.t0);\n                uni.hideLoading();\n\n              case 24:\n                _context2.next = 28;\n                break;\n\n              case 26:\n                console.log(\"\\u8C03\\u8BD5:\\u6CA1\\u6709Xtoken \\u91CD\\u65B0\\u8C03\\u7528\\u767B\\u5F55\");\n                (0, _user.Login)({\n                  token: token\n                });\n\n              case 28:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this, [[5, 20]]);\n      }));\n\n      function loadData() {\n        return _loadData.apply(this, arguments);\n      }\n\n      return loadData;\n    }(),\n    handleToRecharge: function handleToRecharge() {\n      uni.navigateTo({\n        url: '../recharge/recharge'\n      });\n    },\n    handleToRechargeRecord: function handleToRechargeRecord() {\n      uni.navigateTo({\n        url: '../rechargeRecord/rechargeRecord'\n      });\n    },\n    handleToExRecord: function handleToExRecord() {\n      uni.navigateTo({\n        url: '../consumeRecord/consumeRecord'\n      });\n    },\n    handleToRankingList: function handleToRankingList() {\n      uni.navigateTo({\n        url: '../rankingList/rankingList'\n      });\n    },\n    handleToEx: function () {\n      var _handleToEx = _asyncToGenerator(\n      /*#__PURE__*/\n      _regenerator.default.mark(function _callee3() {\n        var res;\n        return _regenerator.default.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                this.modelEx = true;\n                _context3.next = 3;\n                return (0, _user.getExtensionCode)();\n\n              case 3:\n                res = _context3.sent;\n                this.exCode = res;\n\n              case 5:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function handleToEx() {\n        return _handleToEx.apply(this, arguments);\n      }\n\n      return handleToEx;\n    }(),\n    handleSign: function () {\n      var _handleSign = _asyncToGenerator(\n      /*#__PURE__*/\n      _regenerator.default.mark(function _callee4() {\n        var result, error;\n        return _regenerator.default.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                if (this.signInfo.signed) {\n                  _context4.next = 17;\n                  break;\n                }\n\n                _context4.prev = 1;\n                uni.showLoading({\n                  title: '签到中'\n                });\n                _context4.next = 5;\n                return (0, _user.signin)();\n\n              case 5:\n                result = _context4.sent;\n                uni.hideLoading();\n                this.loadData();\n                uni.showModal({\n                  title: '签到成功',\n                  content: \"\\u60A8\\u5DF2\\u8FDE\\u7EED\\u7B7E\\u5230\".concat(result.conn_sign, \"\\u5929,\\u7CAE\\u7968+\").concat(result.addCoin),\n                  showCancel: false\n                });\n                console.log(\"\\u8C03\\u8BD5:\\u7B7E\\u5230\\u8FD4\\u56DE\\u503C\", result);\n                _context4.next = 17;\n                break;\n\n              case 12:\n                _context4.prev = 12;\n                _context4.t0 = _context4[\"catch\"](1);\n                error = _context4.t0.error;\n                uni.hideLoading();\n                uni.showToast({\n                  title: error.msg || '签到失败',\n                  icon: 'none'\n                });\n\n              case 17:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this, [[1, 12]]);\n      }));\n\n      function handleSign() {\n        return _handleSign.apply(this, arguments);\n      }\n\n      return handleSign;\n    }()\n  }\n};\nexports.default = _default;",{"version":3,"sources":["user.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n<page hide-title-bar=\"\"  bg-color=\"#f2f7fa\">\n    <view class=\"header flex justify-center \">\n        <view class=\"bg-avatar shadow shadow-blur padding\">\n            <view class=\"flex justify-between margin-top-xs\">\n               <view>\n                   <view class=\"flex align-center\">\n                       <view class=\"sm cu-avatar round\" :style=\"'background-image: url('+userInfo.headimgurl+')'\"></view>\n                       <view class=\"margin-left-sm\">{{userInfo.nickname}}</view>\n                   </view>\n                   <view>\n                       <view class=\"flex align-end\">\n                           <view class=\"bg-cash margin-bottom-xs\"></view>\n                           <view class=\"text-blance margin-left-sm\">{{userInfo.times}}</view>\n                       </view>\n                       <view class=\"text-sm text-gray margin-top-xs\" @click=\"handleToRechargeRecord\">\n                           充值记录\n                           <text class=\"cuIcon-right\"></text>\n                       </view>\n                   </view>\n               </view>\n                <view class=\" flex align-center \">\n                    <button class=\"cu-btn bg-blue round\" @click=\"handleToRecharge\">\n                        粮票充值\n                    </button>\n                </view>\n            </view>\n        </view>\n    </view>\n    <view class=\"margin-top-xl padding\" style=\"margin-top: 70px;\">\n        <view class=\"text-bold\">免费获取更多粮票</view>\n        <view class=\"flex justify-between bg-white padding radius margin-top align-center\">\n            <view class=\"flex align-center\">\n                <view class=\"text-center\">\n                    <view class=\"text-xxl text-black text-bold\">+10</view>\n                    <view class=\"bg-cash-sm margin-top-xs\" ></view>\n                </view>\n                <view class=\"margin-left\">\n                    <view class=\"text-black text-md\">邀请好友</view>\n                    <view class=\"text-sm text-gray\" style=\"max-width: 350rpx;\">每邀请1名好友,即可获得10张粮票奖励</view>\n                    <view class=\"margin-top-xs flex\">\n                        <view class=\"cu-avatar-group\">\n                            <view v-for=\"(item,index) in exinfo.list\" class=\"cu-avatar round sm\" :style=\"'background-image: url('+item.headimgurl+')'\"></view>\n                        </view>\n                        <view class=\"text-sm text-blue margin-top-xs\" @click=\"handleToExRecord\">\n                            已邀请{{exinfo.total}}人\n                            <text class=\"cuIcon-right\"></text>\n                        </view>\n                    </view>\n                </view>\n            </view>\n            <view>\n                <button class=\"cu-btn sm bg-blue round\" @click=\"handleToEx\">\n                    去邀请\n                </button>\n            </view>\n        </view>\n        <view class=\"flex justify-between bg-white padding radius margin-top align-center\">\n            <view class=\"flex align-center\">\n                <view class=\"text-center\">\n                    <view class=\"text-xl text-black text-bold\">+随机</view>\n                    <view class=\"bg-cash-sm margin-top-xs\" ></view>\n                </view>\n                <view class=\"margin-left\">\n                    <view class=\"text-black text-md\">每日签到</view>\n                    <view class=\"text-sm text-gray\" style=\"max-width: 350rpx;\">每日签到，每日签到可随机获得粮票奖励</view>\n                </view>\n            </view>\n            <view>\n                <button class=\"cu-btn sm bg-blue round\" :disabled=\"signInfo.signed\" @click=\"handleSign\">\n                    {{signInfo.signed?'已签到':'去签到'}}\n                </button>\n            </view>\n        </view>\n        <view class=\"flex justify-between bg-white padding radius margin-top align-center\">\n            <view class=\"flex align-center\">\n                <view class=\"text-center\">\n                    <view class=\"text-xl text-black text-bold\">+N</view>\n                    <view class=\"bg-cash-sm margin-top-xs\" ></view>\n                </view>\n                <view class=\"margin-left\">\n                    <view class=\"text-black text-md\">每周打榜</view>\n                    <view class=\"text-sm text-gray\" style=\"max-width: 350rpx;\">每周打榜</view>\n                </view>\n            </view>\n            <view>\n                <button class=\"cu-btn sm bg-blue round\" @click=\"handleToRankingList\" >\n                    去打榜\n                </button>\n            </view>\n        </view>\n        <view class=\"flex justify-between bg-white padding radius margin-top align-center\">\n            <view class=\"flex align-center\">\n                <view class=\"text-center\">\n                    <view class=\"text-xxl text-black text-bold\">+7</view>\n                    <view class=\"bg-cash-sm margin-top-xs\" ></view>\n                </view>\n                <view class=\"margin-left\">\n                    <view class=\"text-black text-md\">添加客服微信</view>\n                    <view class=\"text-sm text-gray\" style=\"max-width: 350rpx;\">添加客服为好友,可额外获得7枚粮票奖励</view>\n                </view>\n            </view>\n            <view>\n                <button class=\"cu-btn sm bg-blue round\" @click=\"modelKefu = true\">\n                    去完成\n                </button>\n            </view>\n        </view>\n\n\n    </view>\n    <view v-if=\"modelKefu\" class=\"drawer-modal-mask\"></view>\n    <view v-if=\"modelKefu\" class=\"drawer-modal\">\n        <view class=\"drawer-modal-button flex justify-end\">\n            <view class=\"cuIcon-close text-white text-xl margin-right margin-bottom\" @click=\"modelKefu = false\"></view>\n        </view>\n       <view class=\"drawer-modal-content bg-white padding \">\n            <view class=\"text-center margin-bottom\">\n                <view class=\"margin-top\">长按识别下方二维码</view>\n                <view>添加客服微信号，即可领取奖励</view>\n                <image class=\"margin-top\" src=\"../../static/kefu.png\" style=\"height: 400rpx;width: 400rpx;\"></image>\n            </view>\n       </view>\n    </view>\n\n     <modal v-model=\"modelEx\" hide-footer hide-header bg-color=\"none\" >\n        <img :src=\"exCode || `../../static/hongbao.png`\" style=\"width: 100%;\" class=\"radius-xl\"/>\n        <view class=\"bg-white round padding-xs margin-top-xs \" style=\"\">长按分享图片给好友或者保存吧</view>\n     </modal>\n\n</page>\n\n</template>\n\n<script>\n    import Page from \"../component/page/page\";\n    import Modal from \"../component/modal\";\n    import { decodeParams } from \"../../utils/utils\"\n    import {checkSignin, getExtensionCode, getExtensionUser, getUserInfo, Login, signin} from \"../../api/user\";\n    import cache from \"../../utils/cache\";\n    export default {\n        name: \"user\",\n        components: {Modal, Page},\n        data(){\n            return {\n                modelKefu:false,\n                modelEx:false,\n                exinfo:{},\n                userInfo:{},\n                exCode:null,\n                signInfo:{\n                    signed:true\n                }\n            }\n        },\n       async onLoad(options){\n           console.log(`调试:获取到token`, options);\n            this.loadData();\n\n\n\n        },\n        created(options){\n            // console.log(`调试:create->options`, options)\n        },\n        methods:{\n            async loadData(){\n                let token =  cache.get(\"token\");\n                // cache.set(\"token\",token);\n                uni.showLoading({\n                    title:'loading',\n                })\n                let tokens = cache.get(\"tokens\");\n                let xToken = cache.get(\"X-Token\");\n                if(xToken){\n                    try {\n                        let { access_token,openid } = tokens;\n                        this.userInfo  = await getUserInfo({access_token,token,openid});\n                        this.signInfo = await  checkSignin();\n                        console.log(`调试:获取到的签到信息`, this.signInfo);\n\n                        this.exinfo = await  getExtensionUser({page:1,size:5});\n                        // this.exinfo =exinfo\n                        // console.log(`调试:获取到推广用户信息`, exinfo)\n                        uni.hideLoading();\n\n                    }catch (e) {\n                        console.log(`调试:出错`, e);\n                        uni.hideLoading();\n                    }\n                }else{\n                    console.log(`调试:没有Xtoken 重新调用登录`);\n                    Login({token})\n                }\n\n            },\n            handleToRecharge(){\n                uni.navigateTo({\n                    url:'../recharge/recharge'\n                })\n            },\n            handleToRechargeRecord(){\n                uni.navigateTo({\n                    url:'../rechargeRecord/rechargeRecord'\n                })\n            },\n            handleToExRecord(){\n                uni.navigateTo({\n                    url:'../consumeRecord/consumeRecord'\n                })\n            },\n            handleToRankingList(){\n                uni.navigateTo({\n                    url:'../rankingList/rankingList'\n                })\n            },\n            async handleToEx(){\n              this.modelEx = true;\n              let res = await getExtensionCode();\n              this.exCode =res;\n            },\n            async handleSign(){\n                 if(!this.signInfo.signed){\n                      try {\n                          uni.showLoading({title:'签到中'});\n                           let result = await  signin();\n                           uni.hideLoading();\n                           this.loadData();\n                           uni.showModal({\n                               title:'签到成功',\n                               content:`您已连续签到${result.conn_sign}天,粮票+${result.addCoin}`,\n                               showCancel:false\n                           });\n                           console.log(`调试:签到返回值`,result)\n                      }catch ({error}) {\n                          uni.hideLoading();\n                          uni.showToast({\n                              title:error.msg || '签到失败',\n                              icon:'none'\n                          })\n                      }\n                 }\n            }\n        }\n    }\n</script>\n\n<style scoped scoped>\n.header{\n    width: 100%;\n    height: 320rpx;\n    background-image: url(\"../../static/bg_head.png\");\n    background-size: 100% 100%;\n}\n    .bg-avatar{\n        width: 90%;\n        height: 230rpx;\n        background: white;\n        position: relative;\n        background-image: url(\"../../static/bg_info.png\");\n        background-size: 100% 100%;\n        top: 180rpx;\n        box-shadow: 1px 1px 3px #022b777d;\n        border-radius: 10px;\n\n    }\n    .bg-cash{\n        background-image: url(\"../../static/cash_yellow.png\");\n        background-size: 100% 100%;\n        width: 80rpx;\n        height: 45rpx;\n    }\n    .bg-cash-sm{\n        background-image: url(\"../../static/cash_yellow.png\");\n        background-size: 100% 100%;\n        width: 60rpx;\n        height: 35rpx;\n        display: inline-block;\n    }\n    .text-blance{\n        color: black;\n        font-weight: bold;\n        font-size: 60rpx;\n\n    }\n/*    底部抽屉*/\n    .drawer-modal{\n        /*background: white;*/\n        position:absolute;\n        z-index: 99;\n        bottom: 0px;\n        width: 100%;\n    }\n    .drawer-modal-mask{\n        background-color:rgba(0,0,0,0.7);\n        width: 100vw;\n        height: 100vh;\n        position: fixed;\n        z-index: 98;\n        top: 0;\n    }\n    .drawer-modal-content{\n        border-top-left-radius: 50rpx;\n        border-top-right-radius: 50rpx;\n    }\n</style>\n"],"sourceRoot":"src/pages/user"}]}