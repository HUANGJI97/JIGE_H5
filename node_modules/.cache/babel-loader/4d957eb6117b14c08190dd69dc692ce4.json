{"remainingRequest":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js!/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-2!/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-scoped-loader/index.js!/Users/lianfangti/Project/UNI-APP/JIGE/src/pages/rankingList/rankingList.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/src/pages/rankingList/rankingList.vue","mtime":1564817488194},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/vue-loader/lib/index.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-scoped-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _regenerator = _interopRequireDefault(require(\"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@babel/runtime/regenerator\"));\n\nvar _user = require(\"../../api/user\");\n\nvar _cache = _interopRequireDefault(require(\"../../utils/cache\"));\n\nvar _utils = require(\"../../utils/utils\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nvar _default = {\n  name: \"rankingList\",\n  data: function data() {\n    return {\n      ranking: [],\n      index: 0,\n      userInfo: _cache.default.get(\"userInfo\"),\n      active: 0,\n      gifts: [],\n      ex_count: 0,\n      tabs: [{\n        name: '周榜',\n        key: 'week'\n      }, {\n        name: '月榜',\n        key: 'month'\n      }, {\n        name: '总榜',\n        key: 'all'\n      }],\n      exInfo: {}\n    };\n  },\n  onLoad: function () {\n    var _onLoad = _asyncToGenerator(\n    /*#__PURE__*/\n    _regenerator.default.mark(function _callee() {\n      return _regenerator.default.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              this.loadData({\n                index: this.active\n              });\n\n            case 1:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, this);\n    }));\n\n    function onLoad() {\n      return _onLoad.apply(this, arguments);\n    }\n\n    return onLoad;\n  }(),\n  methods: {\n    handleTabChange: function () {\n      var _handleTabChange = _asyncToGenerator(\n      /*#__PURE__*/\n      _regenerator.default.mark(function _callee2(index) {\n        return _regenerator.default.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                this.active = index;\n                this.loadData({\n                  index: index\n                });\n\n              case 2:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function handleTabChange(_x) {\n        return _handleTabChange.apply(this, arguments);\n      }\n\n      return handleTabChange;\n    }(),\n    loadData: function () {\n      var _loadData = _asyncToGenerator(\n      /*#__PURE__*/\n      _regenerator.default.mark(function _callee3() {\n        var _ref,\n            _ref$index,\n            index,\n            data,\n            _index,\n            _args3 = arguments;\n\n        return _regenerator.default.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _ref = _args3.length > 0 && _args3[0] !== undefined ? _args3[0] : {}, _ref$index = _ref.index, index = _ref$index === void 0 ? 0 : _ref$index;\n                uni.showLoading({\n                  title: '请稍后..'\n                });\n                _context3.next = 4;\n                return (0, _user.getRanking)({\n                  type: this.tabs[index].key\n                });\n\n              case 4:\n                data = _context3.sent;\n                this.ranking = data.rank;\n                this.ex_count = data.ex_count; // this.ex_count =data.ex_count;\n                // this.gifts = data.ranking;\n                // let realExCount = this.ranking.length >0 ? this.ranking[0]['ex_count'] : 0; //真实的最大数据\n                // realExCount =  realExCount *1\n                // console.log(`调试:真实的最大邀请量`, realExCount);\n                // for(let i=0;i<10;i++){\n                //       this.ranking.push({\n                //           ex_count: randomIntegerInRange(realExCount,realExCount+100),\n                //           headimgurl:'https://cdn.nlark.com/yuque/0/2018/jpeg/anonymous/1544580626166-9faae07c-19d7-44fd-bbb1-2d246fcc0131.jpeg?x-oss-process=image/resize,m_fill,w_64,h_64/format,png',\n                //           nickname:'Fake User'\n                //       })\n                // }\n                // this.ranking.sort((item1,item2)=>{\n                //     return item2[\"ex_count\"] - item1[\"ex_count\"];\n                // });\n                // this.exInfo= await getExtensionUser({type:this.tabs[index].key});\n\n                _context3.t0 = _regenerator.default.keys(this.ranking);\n\n              case 8:\n                if ((_context3.t1 = _context3.t0()).done) {\n                  _context3.next = 15;\n                  break;\n                }\n\n                _index = _context3.t1.value;\n\n                if (!(this.userInfo.id == this.ranking[_index].uid)) {\n                  _context3.next = 13;\n                  break;\n                }\n\n                this.index = _index * 1 + 1;\n                return _context3.abrupt(\"break\", 15);\n\n              case 13:\n                _context3.next = 8;\n                break;\n\n              case 15:\n                uni.hideLoading();\n\n              case 16:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function loadData() {\n        return _loadData.apply(this, arguments);\n      }\n\n      return loadData;\n    }()\n  }\n};\nexports.default = _default;",{"version":3,"sources":["rankingList.vue"],"names":[],"mappings":";;;;;;;;;AA6CA;;AACA;;AACA;;;;;;;;eAEA;AACA,EAAA,IAAA,EAAA,aADA;AAEA,EAAA,IAFA,kBAEA;AACA,WAAA;AACA,MAAA,OAAA,EAAA,EADA;AAEA,MAAA,KAAA,EAAA,CAFA;AAGA,MAAA,QAAA,EAAA,eAAA,GAAA,CAAA,UAAA,CAHA;AAIA,MAAA,MAAA,EAAA,CAJA;AAKA,MAAA,KAAA,EAAA,EALA;AAMA,MAAA,QAAA,EAAA,CANA;AAOA,MAAA,IAAA,EAAA,CAAA;AAAA,QAAA,IAAA,EAAA,IAAA;AAAA,QAAA,GAAA,EAAA;AAAA,OAAA,EAAA;AAAA,QAAA,IAAA,EAAA,IAAA;AAAA,QAAA,GAAA,EAAA;AAAA,OAAA,EAAA;AAAA,QAAA,IAAA,EAAA,IAAA;AAAA,QAAA,GAAA,EAAA;AAAA,OAAA,CAPA;AAQA,MAAA,MAAA,EAAA;AARA,KAAA;AAUA,GAbA;AAcA,EAAA,MAdA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAeA,mBAAA,QAAA,CAAA;AAAA,gBAAA,KAAA,EAAA,KAAA;AAAA,eAAA;;AAfA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAkBA,EAAA,OAAA,EAAA;AACA,IAAA,eADA;AAAA;AAAA;AAAA,kDACA,KADA;AAAA;AAAA;AAAA;AAAA;AAEA,qBAAA,MAAA,GAAA,KAAA;AACA,qBAAA,QAAA,CAAA;AAAA,kBAAA,KAAA,EAAA;AAAA,iBAAA;;AAHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAMA,IAAA,QANA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,kFAMA,EANA,oBAMA,KANA,EAMA,KANA,2BAMA,CANA;AAOA,gBAAA,GAAA,CAAA,WAAA,CAAA;AACA,kBAAA,KAAA,EAAA;AADA,iBAAA;AAPA;AAAA,uBAUA,sBAAA;AAAA,kBAAA,IAAA,EAAA,KAAA,IAAA,CAAA,KAAA,EAAA;AAAA,iBAAA,CAVA;;AAAA;AAUA,gBAAA,IAVA;AAWA,qBAAA,OAAA,GAAA,IAAA,CAAA,IAAA;AACA,qBAAA,QAAA,GAAA,IAAA,CAAA,QAAA,CAZA,CAaA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AA5BA,yDA6BA,KAAA,OA7BA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AA6BA,gBAAA,MA7BA;;AAAA,sBA8BA,KAAA,QAAA,CAAA,EAAA,IAAA,KAAA,OAAA,CAAA,MAAA,EAAA,GA9BA;AAAA;AAAA;AAAA;;AA+BA,qBAAA,KAAA,GAAA,MAAA,GAAA,CAAA,GAAA,CAAA;AA/BA;;AAAA;AAAA;AAAA;;AAAA;AAmCA,gBAAA,GAAA,CAAA,WAAA;;AAnCA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAlBA,C","sourcesContent":["<template>\n  <view>\n      <view class=\"bg-blue flex  padding-xl justify-between shadow-blur shadow\" style=\"height: 300rpx;padding-left: 100rpx;padding-right: 100rpx;\"  hover-class=\"bg-gradual-blue\">\n           <view class=\" flex align-end\">\n               邀\n               <text class=\"text-xxl\">{{ex_count}}</text>人\n           </view>\n           <view class=\"flex align-end\">\n               <view class=\"text-center\">\n                   <view class=\"margin-bottom\">{{userInfo.nickname}}</view>\n                   <view class=\"cu-avatar xl round\" :style=\"'background-image: url('+userInfo.headimgurl+')'\"></view>\n               </view>\n           </view>\n           <view class=\" flex align-end\">\n               <div v-if=\"ex_count == 0 || index >20\">\n                   未上榜\n               </div>\n               <div v-else>\n                   第\n                   <text class=\"text-xxl\">{{this.index}}</text>\n                   <text>名</text></div>\n           </view>\n      </view>\n      <view class=\"bg-white padding-sm\">\n          <view class=\"flex justify-between margin  round bg-gray shadow\">\n                <view class=\"flex-sub text-center padding-sm round \" :class=\"active === index ? 'bg-blue' :''\" hover-class=\"bg-gradual-blue\" v-for=\"(item,index) in tabs\" @click=\"handleTabChange(index)\">{{item.name}}</view>\n          </view>\n      </view>\n      <view>\n          <view class=\"flex bg-white padding  align-center\" v-for=\"(item,index) in ranking.slice(0,20)\" >\n              <view class=\"flex flex-sub align-center\">\n                  <view class=\"align-center  margin-left margin-right text-bold \">{{(index + 1)>9?index + 1:`0${index + 1}`}}</view>\n                   <view class=\"cu-avatar round margin-right-sm md\" :style=\"'background-image: url('+item.headimgurl+')'\"></view>\n                   <view>\n                       <view>{{item.nickname}}</view>\n                       <view v-if=\"index<11 && active <2\" class=\"text-xs text-gray\">赠:{{item.reward ? item.reward.name : '无'}}</view>\n                   </view>\n              </view>\n              <view class=\"text-xxl margin-right-xl\">{{item.value + item.fake}}</view>\n          </view>\n      </view>\n  </view>\n</template>\n\n<script>\n    import {getExtensionUser, getRanking} from \"../../api/user\";\n    import cache from \"../../utils/cache\";\n    import {randomIntegerInRange} from \"../../utils/utils\";\n\n    export default {\n        name: \"rankingList\",\n        data(){\n          return{\n              ranking:[],\n              index:0,\n              userInfo:cache.get(\"userInfo\"),\n              active:0,\n              gifts:[],\n              ex_count:0,\n              tabs:[{name:'周榜',key:'week'},{name:'月榜',key:'month'},{name:'总榜',key:'all'}],\n              exInfo:{}\n          }\n        },\n        async onLoad(){\n            this.loadData({index:this.active});\n\n        },\n        methods:{\n            async handleTabChange(index){\n                this.active=index;\n                this.loadData({index});\n\n            },\n            async loadData({index = 0}= {}){\n                uni.showLoading({\n                    title:'请稍后..'\n                });\n               let data =  await getRanking({type:this.tabs[index].key});\n                this.ranking = data.rank;\n                this.ex_count = data.ex_count\n                // this.ex_count =data.ex_count;\n                // this.gifts = data.ranking;\n                // let realExCount = this.ranking.length >0 ? this.ranking[0]['ex_count'] : 0; //真实的最大数据\n                // realExCount =  realExCount *1\n                // console.log(`调试:真实的最大邀请量`, realExCount);\n                // for(let i=0;i<10;i++){\n                //       this.ranking.push({\n                //           ex_count: randomIntegerInRange(realExCount,realExCount+100),\n                //           headimgurl:'https://cdn.nlark.com/yuque/0/2018/jpeg/anonymous/1544580626166-9faae07c-19d7-44fd-bbb1-2d246fcc0131.jpeg?x-oss-process=image/resize,m_fill,w_64,h_64/format,png',\n                //           nickname:'Fake User'\n                //       })\n                // }\n                // this.ranking.sort((item1,item2)=>{\n                //     return item2[\"ex_count\"] - item1[\"ex_count\"];\n                // });\n                // this.exInfo= await getExtensionUser({type:this.tabs[index].key});\n                for(let index in this.ranking){\n                    if(this.userInfo.id == this.ranking[index].uid){\n                        this.index = (index * 1) +1;\n                        break;\n                    }\n                }\n                uni.hideLoading();\n            }\n        }\n    }\n</script>\n\n<style scoped scoped>\n\n</style>\n"],"sourceRoot":"src/pages/rankingList"}]}