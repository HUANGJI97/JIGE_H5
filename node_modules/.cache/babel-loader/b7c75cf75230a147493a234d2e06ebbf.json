{"remainingRequest":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/thread-loader/dist/cjs.js!/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js!/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-3!/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-scoped-loader/index.js!/Users/lianfangti/Project/UNI-APP/JIGE/src/pages/user/message.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/src/pages/user/message.vue","mtime":1564926580822},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/vue-loader/lib/index.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-scoped-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _regenerator = _interopRequireDefault(require(\"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@babel/runtime/regenerator\"));\n\nvar _user = require(\"../../api/user\");\n\nvar _modal = _interopRequireDefault(require(\"../component/modal\"));\n\nvar _status = _interopRequireDefault(require(\"../component/status\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nvar _default = {\n  name: \"message\",\n  components: {\n    Status: _status.default,\n    Modal: _modal.default\n  },\n  data: function data() {\n    return {\n      list: [],\n      curentNotice: {},\n      detaileModelVisible: false\n    };\n  },\n  onLoad: function () {\n    var _onLoad = _asyncToGenerator(\n    /*#__PURE__*/\n    _regenerator.default.mark(function _callee() {\n      var notices;\n      return _regenerator.default.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              uni.showLoading({\n                title: '请稍后'\n              });\n              _context.next = 3;\n              return (0, _user.getNotice)();\n\n            case 3:\n              notices = _context.sent;\n              this.list = notices.list;\n              uni.hideLoading();\n\n            case 6:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, this);\n    }));\n\n    function onLoad() {\n      return _onLoad.apply(this, arguments);\n    }\n\n    return onLoad;\n  }(),\n  methods: {\n    handleShowDetaile: function () {\n      var _handleShowDetaile = _asyncToGenerator(\n      /*#__PURE__*/\n      _regenerator.default.mark(function _callee2(item) {\n        var res;\n        return _regenerator.default.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                this.curentNotice = item;\n\n                if (!(item.read_status == 0)) {\n                  _context2.next = 6;\n                  break;\n                }\n\n                _context2.next = 4;\n                return (0, _user.readNotice)({\n                  id: item.id\n                });\n\n              case 4:\n                res = _context2.sent;\n                item.read_status = 1;\n\n              case 6:\n                this.detaileModelVisible = true;\n\n              case 7:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function handleShowDetaile(_x) {\n        return _handleShowDetaile.apply(this, arguments);\n      }\n\n      return handleShowDetaile;\n    }(),\n    handleButtonClick: function () {\n      var _handleButtonClick = _asyncToGenerator(\n      /*#__PURE__*/\n      _regenerator.default.mark(function _callee3() {\n        var _this$curentNotice, coin, type, id, res;\n\n        return _regenerator.default.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _this$curentNotice = this.curentNotice, coin = _this$curentNotice.coin, type = _this$curentNotice.type, id = _this$curentNotice.id;\n\n                if (!(type === 'coin')) {\n                  _context3.next = 6;\n                  break;\n                }\n\n                _context3.next = 4;\n                return (0, _user.getNoticeCoin)({\n                  id: id\n                }).catch(function (err) {\n                  uni.showToast({\n                    title: '领取失败',\n                    icon: 'none'\n                  });\n                  throw err;\n                });\n\n              case 4:\n                res = _context3.sent;\n\n                if (res) {\n                  console.log(\"\\u8C03\\u8BD5:\\u9886\\u53D6\\u6210\\u529F\", res);\n                  uni.showToast({\n                    title: '领取成功'\n                  });\n                  this.curentNotice.get_status = 1;\n                }\n\n              case 6:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function handleButtonClick() {\n        return _handleButtonClick.apply(this, arguments);\n      }\n\n      return handleButtonClick;\n    }()\n  }\n};\nexports.default = _default;",{"version":3,"sources":["message.vue"],"names":[],"mappings":";;;;;;;;;AAuCA;;AACA;;AACA;;;;;;;;eAEA;AACA,EAAA,IAAA,EAAA,SADA;AAEA,EAAA,UAAA,EAAA;AAAA,IAAA,MAAA,EAAA,eAAA;AAAA,IAAA,KAAA,EAAA;AAAA,GAFA;AAGA,EAAA,IAHA,kBAGA;AACA,WAAA;AACA,MAAA,IAAA,EAAA,EADA;AAEA,MAAA,YAAA,EAAA,EAFA;AAGA,MAAA,mBAAA,EAAA;AAHA,KAAA;AAKA,GATA;AAUA,EAAA,MAVA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAWA,cAAA,GAAA,CAAA,WAAA,CAAA;AACA,gBAAA,KAAA,EAAA;AADA,eAAA;AAXA;AAAA,qBAcA,sBAdA;;AAAA;AAcA,cAAA,OAdA;AAeA,mBAAA,IAAA,GAAA,OAAA,CAAA,IAAA;AACA,cAAA,GAAA,CAAA,WAAA;;AAhBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAkBA,EAAA,OAAA,EAAA;AACA,IAAA,iBADA;AAAA;AAAA;AAAA,kDACA,IADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA,qBAAA,YAAA,GAAA,IAAA;;AAFA,sBAGA,IAAA,CAAA,WAAA,IAAA,CAHA;AAAA;AAAA;AAAA;;AAAA;AAAA,uBAIA,sBAAA;AAAA,kBAAA,EAAA,EAAA,IAAA,CAAA;AAAA,iBAAA,CAJA;;AAAA;AAIA,gBAAA,GAJA;AAKA,gBAAA,IAAA,CAAA,WAAA,GAAA,CAAA;;AALA;AAOA,qBAAA,mBAAA,GAAA,IAAA;;AAPA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AASA,IAAA,iBATA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,qCAUA,KAAA,YAVA,EAUA,IAVA,sBAUA,IAVA,EAUA,IAVA,sBAUA,IAVA,EAUA,EAVA,sBAUA,EAVA;;AAAA,sBAWA,IAAA,KAAA,MAXA;AAAA;AAAA;AAAA;;AAAA;AAAA,uBAYA,yBAAA;AAAA,kBAAA,EAAA,EAAA;AAAA,iBAAA,EAAA,KAAA,CAAA,UAAA,GAAA,EAAA;AACA,kBAAA,GAAA,CAAA,SAAA,CAAA;AACA,oBAAA,KAAA,EAAA,MADA;AAEA,oBAAA,IAAA,EAAA;AAFA,mBAAA;AAIA,wBAAA,GAAA;AACA,iBANA,CAZA;;AAAA;AAYA,gBAAA,GAZA;;AAmBA,oBAAA,GAAA,EAAA;AACA,kBAAA,OAAA,CAAA,GAAA,0CAAA,GAAA;AAEA,kBAAA,GAAA,CAAA,SAAA,CAAA;AACA,oBAAA,KAAA,EAAA;AADA,mBAAA;AAGA,uBAAA,YAAA,CAAA,UAAA,GAAA,CAAA;AACA;;AA1BA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAlBA,C","sourcesContent":["<template>\n    <view>\n        <status v-if=\"!list.length\" text=\"暂无消息\"></status>\n        <view class=\"margin\">\n            <view v-for=\"(item,index) in list\" class=\"flex bg-white margin-top-sm padding radius-xxl justify-between\" @tap=\"handleShowDetaile(item)\" >\n                <view class=\"flex \">\n                    <view class=\"flex align-center\">\n                        <view class=\"cu-avatar round lg\" style=\"background-image:url(../../static/notice_icon.png);\">\n                        </view>\n                    </view>\n                    <view class='content margin-left-sm '>\n                        <view class='text-grey'>{{item.title}}\n                            <!--                    <view class=\"cu-tag round bg-orange sm\">c</view>-->\n                        </view>\n                        <view class='text-gray text-sm margin-top-sm' style=\"overflow: hidden;text-overflow:ellipsis;\">\n                            <text class='cuIcon-redpacket_fill text-red' v-if=\"item.type==='coin' && !item.get_status\"></text>{{item.remark}}\n                        </view>\n                    </view>\n                </view>\n                <view >\n                    <view class=\"text-xs text-gray  flex justify-end\">{{item.created_at}}</view>\n                    <view class=\"flex justify-end margin-top-sm\">\n                        <view class=\"cu-tag sm round text-xxxs   margin-top-sm \" :class=\"['bg-red','bg-green'][item.read_status]\">{{['未读','已读'][item.read_status]}}</view>\n                    </view>\n                </view>\n            </view>\n            <modal v-model=\"detaileModelVisible\" hide-footer :title=\"curentNotice.title\">\n                <view v-html=\"curentNotice.content\"></view>\n                <view slot=\"footer\">\n                    <view class=\"flex bg-white justify-center padding-sm\">\n                        <button class=\"cu-btn round \" :class=\"curentNotice.coin ? 'bg-green' : 'bg-blue'\" @tap=\"handleButtonClick\"  :disabled=\"curentNotice.type === 'coin' &&  curentNotice.get_status != 0\">{{curentNotice.coin ?(curentNotice.get_status?'已领取':'领取'):'知道了'}}</button>\n                    </view>\n                </view>\n            </modal>\n        </view>\n    </view>\n</template>\n\n<script>\n    import {getNotice, getNoticeCoin, readNotice} from \"../../api/user\";\n    import Modal from \"../component/modal\";\n    import Status from \"../component/status\";\n\n    export default {\n        name: \"message\",\n        components: {Status, Modal},\n        data(){\n            return {\n                list:[],\n                curentNotice:{},\n                detaileModelVisible:false,\n            }\n        },\n        async onLoad(){\n            uni.showLoading({\n                title:'请稍后'\n            })\n            let notices = await  getNotice();\n            this.list = notices.list\n            uni.hideLoading();\n        },\n        methods:{\n           async  handleShowDetaile(item){\n                this.curentNotice =item;\n                if(item.read_status == 0){\n                    let res= await readNotice({id:item.id});\n                    item.read_status = 1;\n                }\n                this.detaileModelVisible = true\n            },\n            async handleButtonClick(){\n               let {coin,type,id} = this.curentNotice;\n                if(type==='coin'){\n                    let res= await getNoticeCoin({id}).catch(err=>{\n                        uni.showToast({\n                            title:'领取失败',\n                            icon:'none'\n                        })\n                        throw  err;\n                    });\n                    if(res){\n                        console.log(`调试:领取成功`, res);\n\n                        uni.showToast({\n                            title:'领取成功'\n                        })\n                        this.curentNotice.get_status=1;\n                    }\n                }\n            }\n\n        }\n    }\n</script>\n\n<style scoped scoped>\n\n</style>\n"],"sourceRoot":"src/pages/user"}]}