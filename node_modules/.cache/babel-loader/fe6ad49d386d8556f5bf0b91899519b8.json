{"remainingRequest":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/thread-loader/dist/cjs.js!/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js!/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-3!/Users/lianfangti/Project/UNI-APP/JIGE/src/api/user.js","dependencies":[{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/src/api/user.js","mtime":1568258659741},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getUserInfo = getUserInfo;\nexports.getNMSL = getNMSL;\nexports.pullNMSL = pullNMSL;\nexports.getRanking = getRanking;\nexports.getNotice = getNotice;\nexports.readNotice = readNotice;\nexports.getNoticeCoin = getNoticeCoin;\nexports.getExtensionCode = getExtensionCode;\nexports.getExtensionUser = getExtensionUser;\nexports.getAccessToken = getAccessToken;\nexports.Login = Login;\nexports.checkSignin = checkSignin;\nexports.signin = signin;\nexports.getMpConfig = getMpConfig;\nexports.getMobile = getMobile;\n\nvar _regenerator = _interopRequireDefault(require(\"/Users/lianfangti/Project/UNI-APP/JIGE/node_modules/@babel/runtime/regenerator\"));\n\nvar _request = require(\"../utils/request\");\n\nvar _cache = _interopRequireDefault(require(\"../utils/cache\"));\n\nvar _vue = _interopRequireDefault(require(\"vue\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nvar ENV = _vue.default.prototype.ENV;\n/**\n * 获取用户信息\n * @param access_token\n * @param token\n * @param openid\n * @returns {Promise<*>}\n */\n\nfunction getUserInfo(_x) {\n  return _getUserInfo.apply(this, arguments);\n}\n\nfunction _getUserInfo() {\n  _getUserInfo = _asyncToGenerator(\n  /*#__PURE__*/\n  _regenerator.default.mark(function _callee(_ref) {\n    var access_token, token, openid, result;\n    return _regenerator.default.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            access_token = _ref.access_token, token = _ref.token, openid = _ref.openid;\n            _context.next = 3;\n            return _request.request.get({\n              url: '/jige/userinfo',\n              data: {\n                access_token: access_token,\n                token: token,\n                openid: openid\n              }\n            });\n\n          case 3:\n            result = _context.sent;\n\n            _cache.default.set(\"userInfo\", result.data);\n\n            return _context.abrupt(\"return\", result.data);\n\n          case 6:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n  return _getUserInfo.apply(this, arguments);\n}\n\nfunction getNMSL() {\n  return _getNMSL.apply(this, arguments);\n}\n\nfunction _getNMSL() {\n  _getNMSL = _asyncToGenerator(\n  /*#__PURE__*/\n  _regenerator.default.mark(function _callee2() {\n    var _ref2,\n        _ref2$type,\n        type,\n        result,\n        _args2 = arguments;\n\n    return _regenerator.default.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _ref2 = _args2.length > 0 && _args2[0] !== undefined ? _args2[0] : {}, _ref2$type = _ref2.type, type = _ref2$type === void 0 ? 'ktff' : _ref2$type;\n            _context2.next = 3;\n            return _request.request.get({\n              url: '/jige/nmsl',\n              data: {\n                type: type\n              }\n            });\n\n          case 3:\n            result = _context2.sent;\n            return _context2.abrupt(\"return\", result.data);\n\n          case 5:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  }));\n  return _getNMSL.apply(this, arguments);\n}\n\nfunction pullNMSL(_x2) {\n  return _pullNMSL.apply(this, arguments);\n}\n/**\n * 获取排行榜\n * @param type\n * @returns {Promise<*>}\n */\n\n\nfunction _pullNMSL() {\n  _pullNMSL = _asyncToGenerator(\n  /*#__PURE__*/\n  _regenerator.default.mark(function _callee3(_ref3) {\n    var _ref3$type, type, result;\n\n    return _regenerator.default.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            _ref3$type = _ref3.type, type = _ref3$type === void 0 ? 'ktff' : _ref3$type;\n            _context3.next = 3;\n            return _request.request.get({\n              url: '/jige/pullnmsl',\n              data: {\n                type: type\n              }\n            });\n\n          case 3:\n            result = _context3.sent;\n            return _context3.abrupt(\"return\", result.data);\n\n          case 5:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3);\n  }));\n  return _pullNMSL.apply(this, arguments);\n}\n\nfunction getRanking() {\n  return _getRanking.apply(this, arguments);\n}\n\nfunction _getRanking() {\n  _getRanking = _asyncToGenerator(\n  /*#__PURE__*/\n  _regenerator.default.mark(function _callee4() {\n    var _ref4,\n        _ref4$type,\n        type,\n        result,\n        _args4 = arguments;\n\n    return _regenerator.default.wrap(function _callee4$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            _ref4 = _args4.length > 0 && _args4[0] !== undefined ? _args4[0] : {}, _ref4$type = _ref4.type, type = _ref4$type === void 0 ? 'all' : _ref4$type;\n            _context4.next = 3;\n            return _request.request.get({\n              url: '/jige/rank',\n              data: {\n                type: type\n              }\n            });\n\n          case 3:\n            result = _context4.sent;\n            return _context4.abrupt(\"return\", result.data);\n\n          case 5:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, _callee4);\n  }));\n  return _getRanking.apply(this, arguments);\n}\n\nfunction getNotice() {\n  return _getNotice.apply(this, arguments);\n}\n\nfunction _getNotice() {\n  _getNotice = _asyncToGenerator(\n  /*#__PURE__*/\n  _regenerator.default.mark(function _callee5() {\n    var _ref5,\n        _ref5$status,\n        status,\n        result,\n        _args5 = arguments;\n\n    return _regenerator.default.wrap(function _callee5$(_context5) {\n      while (1) {\n        switch (_context5.prev = _context5.next) {\n          case 0:\n            _ref5 = _args5.length > 0 && _args5[0] !== undefined ? _args5[0] : {}, _ref5$status = _ref5.status, status = _ref5$status === void 0 ? 'all' : _ref5$status;\n            _context5.next = 3;\n            return _request.request.get({\n              url: '/notice/list',\n              data: {\n                status: status\n              }\n            });\n\n          case 3:\n            result = _context5.sent;\n            return _context5.abrupt(\"return\", result.data);\n\n          case 5:\n          case \"end\":\n            return _context5.stop();\n        }\n      }\n    }, _callee5);\n  }));\n  return _getNotice.apply(this, arguments);\n}\n\nfunction readNotice(_x3) {\n  return _readNotice.apply(this, arguments);\n}\n\nfunction _readNotice() {\n  _readNotice = _asyncToGenerator(\n  /*#__PURE__*/\n  _regenerator.default.mark(function _callee6(_ref6) {\n    var id, result;\n    return _regenerator.default.wrap(function _callee6$(_context6) {\n      while (1) {\n        switch (_context6.prev = _context6.next) {\n          case 0:\n            id = _ref6.id;\n            _context6.next = 3;\n            return _request.request.post({\n              url: '/notice/read',\n              data: {\n                id: id\n              }\n            });\n\n          case 3:\n            result = _context6.sent;\n            return _context6.abrupt(\"return\", result.data);\n\n          case 5:\n          case \"end\":\n            return _context6.stop();\n        }\n      }\n    }, _callee6);\n  }));\n  return _readNotice.apply(this, arguments);\n}\n\nfunction getNoticeCoin(_x4) {\n  return _getNoticeCoin.apply(this, arguments);\n}\n/**\n * 获取推广码\n * @returns {Promise<any>}\n */\n\n\nfunction _getNoticeCoin() {\n  _getNoticeCoin = _asyncToGenerator(\n  /*#__PURE__*/\n  _regenerator.default.mark(function _callee7(_ref7) {\n    var id, result;\n    return _regenerator.default.wrap(function _callee7$(_context7) {\n      while (1) {\n        switch (_context7.prev = _context7.next) {\n          case 0:\n            id = _ref7.id;\n            _context7.next = 3;\n            return _request.request.post({\n              url: '/notice/getcoin',\n              data: {\n                id: id\n              }\n            });\n\n          case 3:\n            result = _context7.sent;\n            return _context7.abrupt(\"return\", result.data);\n\n          case 5:\n          case \"end\":\n            return _context7.stop();\n        }\n      }\n    }, _callee7);\n  }));\n  return _getNoticeCoin.apply(this, arguments);\n}\n\nfunction getExtensionCode() {\n  return _getExtensionCode.apply(this, arguments);\n}\n\nfunction _getExtensionCode() {\n  _getExtensionCode = _asyncToGenerator(\n  /*#__PURE__*/\n  _regenerator.default.mark(function _callee8() {\n    var result;\n    return _regenerator.default.wrap(function _callee8$(_context8) {\n      while (1) {\n        switch (_context8.prev = _context8.next) {\n          case 0:\n            if (!_cache.default.get(\"exCode\")) {\n              _context8.next = 4;\n              break;\n            }\n\n            return _context8.abrupt(\"return\", _cache.default.get(\"exCode\"));\n\n          case 4:\n            _context8.next = 6;\n            return _request.request.get({\n              url: '/jige/extensioncode'\n            });\n\n          case 6:\n            result = _context8.sent;\n\n            _cache.default.set(\"exCode\", result.data);\n\n            return _context8.abrupt(\"return\", result.data);\n\n          case 9:\n          case \"end\":\n            return _context8.stop();\n        }\n      }\n    }, _callee8);\n  }));\n  return _getExtensionCode.apply(this, arguments);\n}\n\nfunction getExtensionUser() {\n  return _getExtensionUser.apply(this, arguments);\n}\n/**\n * 获取access_token\n * @param code\n * @param token\n * @returns {Promise<*>}\n */\n\n\nfunction _getExtensionUser() {\n  _getExtensionUser = _asyncToGenerator(\n  /*#__PURE__*/\n  _regenerator.default.mark(function _callee9() {\n    var _ref8,\n        _ref8$page,\n        page,\n        _ref8$size,\n        size,\n        _ref8$type,\n        type,\n        token,\n        _cache$get,\n        id,\n        result,\n        _args9 = arguments;\n\n    return _regenerator.default.wrap(function _callee9$(_context9) {\n      while (1) {\n        switch (_context9.prev = _context9.next) {\n          case 0:\n            _ref8 = _args9.length > 0 && _args9[0] !== undefined ? _args9[0] : {}, _ref8$page = _ref8.page, page = _ref8$page === void 0 ? 1 : _ref8$page, _ref8$size = _ref8.size, size = _ref8$size === void 0 ? 20 : _ref8$size, _ref8$type = _ref8.type, type = _ref8$type === void 0 ? 'all' : _ref8$type;\n            token = _cache.default.get('token');\n            _cache$get = _cache.default.get(\"userInfo\"), id = _cache$get.id;\n            _context9.next = 5;\n            return _request.request.get({\n              url: '/jige/extensionuser',\n              data: {\n                token: token,\n                id: id,\n                page: page,\n                size: size,\n                type: type\n              }\n            });\n\n          case 5:\n            result = _context9.sent;\n            return _context9.abrupt(\"return\", result.data);\n\n          case 7:\n          case \"end\":\n            return _context9.stop();\n        }\n      }\n    }, _callee9);\n  }));\n  return _getExtensionUser.apply(this, arguments);\n}\n\nfunction getAccessToken(_x5) {\n  return _getAccessToken.apply(this, arguments);\n}\n/**\n * 用户登录\n * @param token\n * @returns {Promise<void>}\n * @constructor\n */\n\n\nfunction _getAccessToken() {\n  _getAccessToken = _asyncToGenerator(\n  /*#__PURE__*/\n  _regenerator.default.mark(function _callee10(_ref9) {\n    var code, token, result;\n    return _regenerator.default.wrap(function _callee10$(_context10) {\n      while (1) {\n        switch (_context10.prev = _context10.next) {\n          case 0:\n            code = _ref9.code, token = _ref9.token;\n            _context10.next = 3;\n            return _request.request.get({\n              url: '/jige/access_token',\n              data: {\n                code: code,\n                token: token\n              }\n            }).catch(function (_ref12) {\n              var error = _ref12.error;\n              console.log(\"\\u8C03\\u8BD5:\\u9519\\u8BEF\", error);\n\n              if (error.code) {\n                Login({\n                  token: token\n                });\n              } else {}\n\n              return Promise.reject(error);\n            });\n\n          case 3:\n            result = _context10.sent;\n            console.log(\"\\u8C03\\u8BD5:\\u83B7\\u53D6\\u5230\\u7684AccessToken\\u4FE1\\u606F\", result.data);\n\n            _cache.default.set('X-Token', result.data.openid);\n\n            _cache.default.set(\"tokens\", result.data);\n\n            return _context10.abrupt(\"return\", result.data);\n\n          case 8:\n          case \"end\":\n            return _context10.stop();\n        }\n      }\n    }, _callee10);\n  }));\n  return _getAccessToken.apply(this, arguments);\n}\n\nfunction Login(_x6) {\n  return _Login.apply(this, arguments);\n}\n/**\n * 检查签到\n * @date 2019年07月08日15:52:22\n * @returns {Promise<void>}\n */\n\n\nfunction _Login() {\n  _Login = _asyncToGenerator(\n  /*#__PURE__*/\n  _regenerator.default.mark(function _callee11(_ref10) {\n    var token, _ref10$env, env, _ref13, url;\n\n    return _regenerator.default.wrap(function _callee11$(_context11) {\n      while (1) {\n        switch (_context11.prev = _context11.next) {\n          case 0:\n            token = _ref10.token, _ref10$env = _ref10.env, env = _ref10$env === void 0 ? ENV : _ref10$env;\n            // let {code} = await wxlogin();\n            console.log(\"\\u8C03\\u8BD5:\\u5F00\\u59CB\\u767B\\u5F55\", token);\n            _context11.next = 4;\n            return _request.request.get({\n              url: '/jige/login',\n              data: {\n                token: token,\n                env: env\n              }\n            }).catch(function (_ref14) {\n              var error = _ref14.error;\n              console.log(\"\\u8C03\\u8BD5:\\u51FA\\u9519\", error);\n\n              if (error.code == 400) {\n                window.location.href = window.location.protocol + \"//\" + window.location.host;\n              }\n            });\n\n          case 4:\n            _ref13 = _context11.sent;\n            url = _ref13.data.url;\n            window.location.href = url;\n            console.log(\"\\u8C03\\u8BD5:\\u83B7\\u53D6\\u6388\\u6743url\", url);\n\n          case 8:\n          case \"end\":\n            return _context11.stop();\n        }\n      }\n    }, _callee11);\n  }));\n  return _Login.apply(this, arguments);\n}\n\nfunction checkSignin() {\n  return _checkSignin.apply(this, arguments);\n}\n/**\n * 签到\n * @returns {Promise<*>}\n */\n\n\nfunction _checkSignin() {\n  _checkSignin = _asyncToGenerator(\n  /*#__PURE__*/\n  _regenerator.default.mark(function _callee12() {\n    var result;\n    return _regenerator.default.wrap(function _callee12$(_context12) {\n      while (1) {\n        switch (_context12.prev = _context12.next) {\n          case 0:\n            _context12.next = 2;\n            return _request.request.get({\n              url: '/jige/checksignin'\n            });\n\n          case 2:\n            result = _context12.sent;\n            return _context12.abrupt(\"return\", result.data);\n\n          case 4:\n          case \"end\":\n            return _context12.stop();\n        }\n      }\n    }, _callee12);\n  }));\n  return _checkSignin.apply(this, arguments);\n}\n\nfunction signin() {\n  return _signin.apply(this, arguments);\n}\n\nfunction _signin() {\n  _signin = _asyncToGenerator(\n  /*#__PURE__*/\n  _regenerator.default.mark(function _callee13() {\n    var result;\n    return _regenerator.default.wrap(function _callee13$(_context13) {\n      while (1) {\n        switch (_context13.prev = _context13.next) {\n          case 0:\n            _context13.next = 2;\n            return _request.request.post({\n              url: '/jige/signin'\n            });\n\n          case 2:\n            result = _context13.sent;\n            return _context13.abrupt(\"return\", result.data);\n\n          case 4:\n          case \"end\":\n            return _context13.stop();\n        }\n      }\n    }, _callee13);\n  }));\n  return _signin.apply(this, arguments);\n}\n\nfunction getMpConfig() {\n  return _getMpConfig.apply(this, arguments);\n}\n\nfunction _getMpConfig() {\n  _getMpConfig = _asyncToGenerator(\n  /*#__PURE__*/\n  _regenerator.default.mark(function _callee14() {\n    var result;\n    return _regenerator.default.wrap(function _callee14$(_context14) {\n      while (1) {\n        switch (_context14.prev = _context14.next) {\n          case 0:\n            _context14.next = 2;\n            return _request.request.get({\n              url: '/jige/system_config'\n            });\n\n          case 2:\n            result = _context14.sent;\n            return _context14.abrupt(\"return\", result.data);\n\n          case 4:\n          case \"end\":\n            return _context14.stop();\n        }\n      }\n    }, _callee14);\n  }));\n  return _getMpConfig.apply(this, arguments);\n}\n\nfunction getMobile(_x7) {\n  return _getMobile.apply(this, arguments);\n}\n/**\n * 获取登录code\n * @type: Object\n * @returns 返回code\n * @Auth: lianfangti@qq.com\n * @Date: 2019-06-27 16:44:42\n * **/\n\n\nfunction _getMobile() {\n  _getMobile = _asyncToGenerator(\n  /*#__PURE__*/\n  _regenerator.default.mark(function _callee15(_ref11) {\n    var encryptedData, iv, mobie;\n    return _regenerator.default.wrap(function _callee15$(_context15) {\n      while (1) {\n        switch (_context15.prev = _context15.next) {\n          case 0:\n            encryptedData = _ref11.encryptedData, iv = _ref11.iv;\n            _context15.next = 3;\n            return _request.request.post({\n              url: \"/wxfanmobile\",\n              data: {\n                encryptedData: encryptedData,\n                iv: iv\n              }\n            });\n\n          case 3:\n            mobie = _context15.sent;\n            console.log(\"\\u8C03\\u8BD5:\\u83B7\\u53D6\\u624B\\u673A\\u53F7\\u4FE1\\u606F\", mobie); // console.log(`调试:获取用户信息`, encryptedData,iv)\n\n          case 5:\n          case \"end\":\n            return _context15.stop();\n        }\n      }\n    }, _callee15);\n  }));\n  return _getMobile.apply(this, arguments);\n}\n\nfunction wxlogin() {\n  return _wxlogin.apply(this, arguments);\n}\n/**\n * 获取小程序设置信息\n * @type: Object\n * @returns 返回小程序设置信息\n * @Auth: lianfangti@qq.com\n * @Date: 2019-06-27 16:42:42\n * **/\n\n\nfunction _wxlogin() {\n  _wxlogin = _asyncToGenerator(\n  /*#__PURE__*/\n  _regenerator.default.mark(function _callee16() {\n    return _regenerator.default.wrap(function _callee16$(_context16) {\n      while (1) {\n        switch (_context16.prev = _context16.next) {\n          case 0:\n            _context16.next = 2;\n            return new Promise(function (resolve, reject) {\n              uni.login({\n                success: resolve,\n                fail: reject\n              });\n            });\n\n          case 2:\n            return _context16.abrupt(\"return\", _context16.sent);\n\n          case 3:\n          case \"end\":\n            return _context16.stop();\n        }\n      }\n    }, _callee16);\n  }));\n  return _wxlogin.apply(this, arguments);\n}\n\nfunction getSetting() {\n  return _getSetting.apply(this, arguments);\n}\n\nfunction _getSetting() {\n  _getSetting = _asyncToGenerator(\n  /*#__PURE__*/\n  _regenerator.default.mark(function _callee17() {\n    return _regenerator.default.wrap(function _callee17$(_context17) {\n      while (1) {\n        switch (_context17.prev = _context17.next) {\n          case 0:\n            _context17.next = 2;\n            return new Promise(function (resolve, reject) {\n              uni.getSetting({\n                success: function success(res) {\n                  // console.log(`调试:获取设置信息成功`, res)\n                  resolve(res.authSetting);\n                },\n                fail: function fail(err) {\n                  reject({\n                    from: 'getSetting',\n                    error: err\n                  });\n                }\n              });\n            });\n\n          case 2:\n            return _context17.abrupt(\"return\", _context17.sent);\n\n          case 3:\n          case \"end\":\n            return _context17.stop();\n        }\n      }\n    }, _callee17);\n  }));\n  return _getSetting.apply(this, arguments);\n}\n\nfunction getFackUser() {\n  return _getFackUser.apply(this, arguments);\n}\n\nfunction _getFackUser() {\n  _getFackUser = _asyncToGenerator(\n  /*#__PURE__*/\n  _regenerator.default.mark(function _callee18() {\n    var headimgurls, list;\n    return _regenerator.default.wrap(function _callee18$(_context18) {\n      while (1) {\n        switch (_context18.prev = _context18.next) {\n          case 0:\n            headimgurls = [\"https://cdn.nlark.com/yuque/0/2018/jpeg/anonymous/1544580626166-9faae07c-19d7-44fd-bbb1-2d246fcc0131.jpeg?x-oss-process=image/resize,m_fill,w_64,h_64/format,png\", \"https://cdn.nlark.com/yuque/0/2019/jpeg/anonymous/1551610186785-77ea1fa8-22d8-4a98-8d29-bd4bb5197349.jpeg?x-oss-process=image/resize,m_fill,w_64,h_64/format,png\", \"\", \"\", \"\", \"\", \"\"];\n            list = {};\n\n          case 2:\n          case \"end\":\n            return _context18.stop();\n        }\n      }\n    }, _callee18);\n  }));\n  return _getFackUser.apply(this, arguments);\n}",{"version":3,"sources":["/Users/lianfangti/Project/UNI-APP/JIGE/src/api/user.js"],"names":["ENV","Vue","prototype","getUserInfo","access_token","token","openid","request","get","url","data","result","cache","set","getNMSL","type","pullNMSL","getRanking","getNotice","status","readNotice","id","post","getNoticeCoin","getExtensionCode","getExtensionUser","page","size","getAccessToken","code","catch","error","console","log","Login","Promise","reject","env","window","location","href","protocol","host","checkSignin","signin","getMpConfig","getMobile","encryptedData","iv","mobie","wxlogin","resolve","uni","login","success","fail","getSetting","res","authSetting","err","from","getFackUser","headimgurls","list"],"mappings":"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","sourcesContent":["import {request} from \"../utils/request\";\nimport cache from \"../utils/cache\"\nimport  Vue from  'vue'\nconst ENV = Vue.prototype.ENV;\n\n\n\n/**\n * 获取用户信息\n * @param access_token\n * @param token\n * @param openid\n * @returns {Promise<*>}\n */\nexport async function getUserInfo({access_token,token,openid}) {\n    let result =   await  request.get({\n        url:'/jige/userinfo',\n        data:{\n            access_token,\n            token,\n            openid\n        }\n    });\n    cache.set(\"userInfo\",result.data);\n    return  result.data\n}\n\nexport  async function getNMSL({type = 'ktff'}={}) {\n    let result = await request.get({\n        url:'/jige/nmsl',\n        data:{type}\n    });\n    return  result.data\n}\nexport  async function pullNMSL({type='ktff'}) {\n    let result = await request.get({\n        url:'/jige/pullnmsl',\n        data:{type}\n\n    });\n    return  result.data\n}\n/**\n * 获取排行榜\n * @param type\n * @returns {Promise<*>}\n */\nexport async function getRanking({type = 'all'} = {}){\n let result = await request.get({\n   url:'/jige/rank',\n   data:{\n       type\n   }\n })\n return  result.data\n}\n\n\nexport async function getNotice({status = 'all'} = {}){\n let result = await request.get({\n   url:'/notice/list',\n   data:{\n       status\n   }\n })\n return  result.data\n}\n\nexport async function readNotice({id}){\n let result = await request.post({\n   url:'/notice/read',\n   data:{\n       id\n   }\n })\n return  result.data\n}\nexport async function getNoticeCoin({id}){\n let result = await request.post({\n   url:'/notice/getcoin',\n   data:{\n       id\n   }\n })\n return  result.data\n}\n\n/**\n * 获取推广码\n * @returns {Promise<any>}\n */\nexport async function  getExtensionCode(){\n    if(cache.get(\"exCode\")){\n        return  cache.get(\"exCode\")\n    }else{\n        let result = await request.get({\n            url:'/jige/extensioncode',\n        });\n        cache.set(\"exCode\",result.data);\n        return  result.data\n    }\n\n}\n\n\nexport async function getExtensionUser({page=1,size=20,type='all'}={}){\n    let  token = cache.get('token');\n    let {id} =cache.get(\"userInfo\");\n    let result = await request.get({\n      url:'/jige/extensionuser',\n      data:{\n          token,\n          id,\n          page,\n          size,\n          type\n      }\n    });\n    return  result.data\n}\n\n/**\n * 获取access_token\n * @param code\n * @param token\n * @returns {Promise<*>}\n */\nexport async function getAccessToken({code,token}) {\n   let result =   await  request.get({\n        url:'/jige/access_token',\n        data:{\n            code,\n            token\n        }\n    }).catch(({error})=>{\n        console.log(`调试:错误`,error);\n        if(error.code){\n            Login({token});\n        }else{\n        }\n        return Promise.reject(error);\n   });\n    console.log(`调试:获取到的AccessToken信息`, result.data);\n    cache.set('X-Token',result.data.openid);\n    cache.set(\"tokens\",result.data);\n\n    return  result.data\n}\n\n\n\n/**\n * 用户登录\n * @param token\n * @returns {Promise<void>}\n * @constructor\n */\n\nexport async function Login({token,env=ENV}) {\n    // let {code} = await wxlogin();\n    console.log(`调试:开始登录`, token);\n    let {data:{url}} =  await request.get({\n        url: '/jige/login',\n        data:{\n            token,env\n        }\n    }).catch(({error})=>{\n        console.log(`调试:出错`, error);\n        if(error.code == 400){\n            window.location.href =window.location.protocol + \"//\" + window.location.host\n        }\n\n    });\n    window.location.href = url;\n    console.log(`调试:获取授权url`, url);\n}\n\n/**\n * 检查签到\n * @date 2019年07月08日15:52:22\n * @returns {Promise<void>}\n */\nexport async function checkSignin(){\n  let result =  await request.get({\n    url:'/jige/checksignin'\n  })\n  return  result.data\n}\n\n/**\n * 签到\n * @returns {Promise<*>}\n */\nexport async function signin(){\n    let result =  await request.post({\n        url:'/jige/signin'\n    })\n    return  result.data\n}\n\n\nexport async function getMpConfig(){\n    let result =  await request.get({\n        url:'/jige/system_config'\n    })\n    return  result.data\n}\n\n\n\nexport async function getMobile({encryptedData,iv }) {\n    // const login = await wxlogin();\n    // const {encryptedData, iv} = await getUserInfo({jump: true});\n    let mobie = await request.post({\n        url: `/wxfanmobile`,\n        data: {\n            encryptedData,\n            iv,\n        }\n    })\n    console.log(`调试:获取手机号信息`, mobie)\n    // console.log(`调试:获取用户信息`, encryptedData,iv)\n}\n\n\n/**\n * 获取登录code\n * @type: Object\n * @returns 返回code\n * @Auth: lianfangti@qq.com\n * @Date: 2019-06-27 16:44:42\n * **/\n\nasync function wxlogin() {\n    return await new Promise((resolve, reject) => {\n        uni.login({\n            success: resolve,\n            fail: reject\n        })\n    })\n\n}\n\n\n/**\n * 获取小程序设置信息\n * @type: Object\n * @returns 返回小程序设置信息\n * @Auth: lianfangti@qq.com\n * @Date: 2019-06-27 16:42:42\n * **/\nasync function getSetting() {\n    return await new Promise((resolve, reject) => {\n        uni.getSetting({\n            success(res) {\n                // console.log(`调试:获取设置信息成功`, res)\n                resolve(res.authSetting);\n            },\n            fail(err) {\n                reject({from: 'getSetting', error: err})\n            }\n        })\n    })\n}\n\nasync function getFackUser(){\n    let headimgurls=[\n        \"https://cdn.nlark.com/yuque/0/2018/jpeg/anonymous/1544580626166-9faae07c-19d7-44fd-bbb1-2d246fcc0131.jpeg?x-oss-process=image/resize,m_fill,w_64,h_64/format,png\",\n        \"https://cdn.nlark.com/yuque/0/2019/jpeg/anonymous/1551610186785-77ea1fa8-22d8-4a98-8d29-bd4bb5197349.jpeg?x-oss-process=image/resize,m_fill,w_64,h_64/format,png\",\n        \"\",\n        \"\",\n        \"\",\n        \"\",\n        \"\",\n    ]\n    let list = {\n\n    }\n}\n\n\n"]}]}